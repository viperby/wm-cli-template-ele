{"remainingRequest":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GaeaProject\\jpn_medical_web\\pages\\main\\im\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\GaeaProject\\jpn_medical_web\\pages\\main\\im\\index.vue","mtime":1601036333108},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCglpbXBvcnQge21hcFN0YXRlLG1hcE11dGF0aW9uc30gZnJvbSAndnVleCcKCWxldCBpbWdVcmwgPSByZXF1aXJlKCdAL3NyYy9hc3NldHMvaW1hZ2VzL2xvZ2luL2xvZ28yLnBuZycpCglleHBvcnQgZGVmYXVsdCB7CgkJY29tcHV0ZWQ6IHsKCQkJLi4ubWFwU3RhdGUoWyJub3RpY2VFeCJdKSwKCQl9LAoJCWRhdGEoKXsKCQkJcmV0dXJuIHsKCQkJCWlzQWN0aXZlOiAiLTEiLAoJCQkJaXNCdXR0b246IGZhbHNlLAoJCQkJaXNMb2FkaW5nOiBmYWxzZSwKCQkJCXNlbmRUZXh0OiAiIiwvLyDovpPlhaXmloflrZcKCQkJCWN1cnJlbnQ6IHt9LC8vIOW9k+WJjeeUqOaIt+S/oeaBrwoJCQkJY2hhcnRzSGlzdG9yeTogW10sIC8vIOa2iOaBrwoJCQkJY2FuZGlkYXRlOiBbXSwgLy8g5b6F5o6l6amzCgkJCQloYXNDYW5kaWRhdGU6IFtdLCAvLyDooqvlhbbku5blrqLmnI3mjqXpqbMKCQkJCWhpc3RvcnlDdXN0b21lcjogW10sIC8vIOW3sue7j+aOpempswoJCQkJaGlzdG9yeVBhZ2VJbmRleDogMCwgLy8g5Y6G5Y+y6K6w5b2V5p+l6K+i6aG15pWwMOW8gOWniwoJCQkJaGlzdG9yeVBhZ2VTaXplOiA5LCAvLyDljoblj7LorrDlvZXmn6Xor6LmnaHmlbAKCQkJCXVybDogaW1nVXJsLCAvLyDpu5jorqTns7vnu5/lpLTlg48KCQkJCXZpZXc6IHsKCQkJCQl0YWJsZUhlaWdodDogNjUwCgkJCQl9LAoJCQkJU3lzTWVzc2FnZUNvbnRlbnREaWM6ey8v57O757uf6YCa55+l5YaF5a655a+554WnCgkJCQkJJ01lZGljYWxDaGFydFJvb21fUXVpdCc6J+WuouaIt+W3sumAgOWHuuiBiuWkqe+8jOezu+e7n+W3suS4uuaCqOWIh+aNouWIsOeVmeiogOaooeW8j++8geWcqCLnu5PmnZ/mnI3liqEi5YmN77yM5oKo55qE5raI5oGv5bCG6YCa6L+H55WZ6KiA55qE5pa55byP77yM5Y+R57uZ6YCB5a6i5oi344CCJwoJCQkJfQoJCQl9CgkJfSwKCQltZXRob2RzOnsKCQkJZ2V0U2VuZGVyKCl7CgkJCQlyZXR1cm4gewoJCQkJCSJUb2tlbiI6dGhpcy5ub3RpY2VFeC5pbmZvLnRva2VuLAoJCQkJCSJUeXBlIjoiYXBwIiwKCQkJCQkiRnJvbSI6ewoJCQkJCQkiTmFtZSI6dGhpcy5ub3RpY2VFeC5pbmZvLnVzZXIubmFtZSwKCQkJCQkJIkd1aWQiOnRoaXMubm90aWNlRXguaW5mby51c2VyLmd1aWQsCgkJCQkJfSwKCQkJCQkiRGF0YSI6ewoJCQkJCQkiTWVzc2FnZSI6IiIsCgkJCQkJCSJBY2NlcHQiOnsKCQkJCQkJCSJHdWlkIjoiIgoJCQkJCQl9LAoJCQkJCQkiVHlwZSI6ImNzIgoJCQkJCX0KCQkJCX0KCQkJfSwKCQkJYXN5bmMgZ2V0Q2FuZGlkYXRlTGlzdCgpIHsKCQkJCWxldCByZXMgPSBhd2FpdCB0aGlzLm5vdGljZUV4Lm5vdGljZUdldCgiL2NoYXJ0L2dldGNhbmRpZGF0ZSIsIHtUb2tlbjogdGhpcy5ub3RpY2VFeC5pbmZvLnRva2VufSkKCQkJCWNvbnNvbGUubG9nKHJlcyk7CgkJCQlpZighcmVzLlN1Y2Nlc3MpewoJCQkJCXRoaXMuJHRpcHMud2FybmluZygi6I635Y+W5bim5o6l6amz5a6i5oi35aSx6LSlIik7CgkJCQkJcmV0dXJuCgkJCQl9CgkJCQl0aGlzLmNhbmRpZGF0ZSA9IHJlcy5EYXRhCgkJCX0sCgkJCS8vIOWPkemAgQoJCQlzZW5kSW5mbygpIHsKCQkJCS8vIOWFiOWIpOaWreaYr+WQpuS4uuepuiAKCQkJCWlmKHRoaXMuc2VuZFRleHQgIT09ICIiKSB7CgkJCQkJLy8g5Lya6K+d5bey57uP57uT5p2fIHx8IOW+heaOpemps+eKtuaAge+8jOWPkeezu+e7n+a2iOaBr+aPkOekuuW5tuaJp+ihjOa7muWKqOOAgea4heepuuaWh+acrOahhgoJCQkJCWlmICh0aGlzLmN1cnJlbnQuVXNlckF1dGggPT0gMHx8IXRoaXMuY3VycmVudC5DaGFydFJvb21HdWlkIHx8IHRoaXMuY3VycmVudC5DaGFydFJvb21HdWlkLmxlbmd0aCA9PSAwKSB7CgkJCQkJCWxldCBzZW5kZXIgPSB0aGlzLmdldFNlbmRlcigpCgkJCQkJCXNlbmRlci5Gcm9tLkd1aWQgPSAiIjsKCQkJCQkJc2VuZGVyLkZyb20uTmFtZSA9ICIiOwoJCQkJCQlzZW5kZXIuRGF0YS5NZXNzYWdlID0gewoJCQkJCQkJVHlwZTogInN5cyIsCgkJCQkJCQlDb250ZW50OiAi5Y+R6YCB5aSx6LSl77yM5b2T5YmN5LiN6IO95Y+R6YCB5raI5oGv77yBIiwKCQkJCQkJfQoJCQkJCQl0aGlzLmNoYXJ0c0hpc3RvcnkucHVzaChzZW5kZXIpCgkJCQkJCXRoaXMubWF4U2Nyb2xsVG9wKCk7CgkJCQkJCXRoaXMuc2VuZFRleHQgPSAnJzsKCQkJCQkJLy8gY29uc29sZS5sb2codGhpcy5jaGFydHNIaXN0b3J5KTsKCQkJCQkJcmV0dXJuCgkJCQkJfQoJCQkJCS8vIOiupOmihuWujOWQjiDmiJbogIUg5Y6G5Y+y6K6k6aKG5rKh5pyJ57uT5p2f5Lya6K+d5Y+v5Y+R6YCBCgkJCQkJLy8g5Y+R6YCB5pyN5YqhCgkJCQkJbGV0IHNlbmRlciA9IHRoaXMuZ2V0U2VuZGVyKCkgLy8g5qC85byP5YyWCgkJCQkJc2VuZGVyLkRhdGEuQWNjZXB0Lkd1aWQgPXRoaXMuY3VycmVudC5DaGFydFJvb21HdWlkOwoJCQkJCXNlbmRlci5EYXRhLk1lc3NhZ2UgPSBKU09OLnN0cmluZ2lmeSh7VHlwZToiaW5mbyIsQ29udGVudDp0aGlzLnNlbmRUZXh0fSk7CgkJCQkJLy8g5pi+56S65Zyo56qX5Y+j5YGH5L+h5oGvCgkJCQkJbGV0IG1zID0gdGhpcy5nZXRTZW5kZXIoKQoJCQkJCW1zLkRhdGEuQWNjZXB0Lkd1aWQgPXRoaXMuY3VycmVudC5DaGFydFJvb21HdWlkOwoJCQkJCW1zLkRhdGEuTWVzc2FnZSA9IHsKCQkJCQkJVHlwZTogImluZm8iLAoJCQkJCQlDb250ZW50OiB0aGlzLnNlbmRUZXh0CgkJCQkJfTsKCQkJCQl0aGlzLmNoYXJ0c0hpc3RvcnkucHVzaChtcyk7CgkJCQkJdHJ5ewoJCQkJCQl0aGlzLm5vdGljZUV4LnNlbmRTb2N1cmUoc2VuZGVyKTsgLy8g5Lyg6L6TCgkJCQkJfWNhdGNoKGUpewoJCQkJCQljb25zb2xlLmxvZyhlKQoJCQkJCX0KCQkJCQl0aGlzLnNlbmRUZXh0ID0gJyc7CgkJCQkJdGhpcy5tYXhTY3JvbGxUb3AoKTsKCQkJCX1lbHNlIHsKCQkJCQl0aGlzLiR0aXBzLndhcm5pbmcoIuivt+i+k+WFpea2iOaBryIpOwoJCQkJfQoJCQl9LAoJCQkvLyDplK7nm5jnm5HlkKzkuovku7YKCQkJYWRkQnlFbnRlcktleShlKSB7CgkJCQkvLyDliKDpmaTpu5jorqTkuovku7Yg5Y+W5raI5Zue6L2m5o2i6KGMCgkJCQkvLyBlLnByZXZlbnREZWZhdWx0KCkKCQkJCWlmIChlLmtleUNvZGUgPT0gMTMpIHsKCQkJCQl0aGlzLnNlbmRJbmZvKCkKCQkJCX0KCQkJfSwKCQkJYXN5bmMgZ2V0SGlzdG9yeUN1c3RvbWVyKCkgewoJCQkJbGV0IHJlcyA9IGF3YWl0IHRoaXMubm90aWNlRXgubm90aWNlR2V0KCIvY2hhcnQvZ2V0dXNlcmNoYXJ0cm9vbXMiLCB7VG9rZW46IHRoaXMubm90aWNlRXguaW5mby50b2tlbn0pCgkJCQl0aGlzLmhpc3RvcnlDdXN0b21lciA9IHJlcy5EYXRhCgkJCQlpZighcmVzLlN1Y2Nlc3MpewoJCQkJCXRoaXMuJHRpcHMud2FybmluZygi6I635Y+W5oi/6Ze05aSx6LSlIik7CgkJCQkJcmV0dXJuCgkJCQl9CgkJCQkvLyBjb25zb2xlLmxvZyhyZXMpOwoJCQl9LAoJCQkvLyDljoblj7LorrDlvZUKCQkJYXN5bmMgZ2V0SGlzdG9yeUluZm8oKSB7CgkJCQl0aGlzLmlzTG9hZGluZyA9IHRydWUKCQkJCWxldCBwYXJhbXMgPSB7CgkJCQkJVG9rZW46IHRoaXMubm90aWNlRXguaW5mby50b2tlbiwKCQkJCQlQYWdlSW5kZXg6IHRoaXMuaGlzdG9yeVBhZ2VJbmRleCwKCQkJCQlQYWdlU2l6ZTogdGhpcy5oaXN0b3J5UGFnZVNpemUsCgkJCQkJQ2hhcnRSb29tR3VpZDogdGhpcy5jdXJyZW50LkNoYXJ0Um9vbUd1aWQKCQkJCX0KCQkJCWxldCByZXMgPSBhd2FpdCB0aGlzLm5vdGljZUV4Lm5vdGljZUdldCgiL2NoYXJ0L2dldGNoYXJ0cm9vbWhpc3RvcnlpbmZvIiwgcGFyYW1zKQoJCQkJaWYoIXJlcy5TdWNjZXNzKXsKCQkJCQlpZiAocmVzLkNvZGUgPT0gMTEwMSkgewoJCQkJCQl0aGlzLiR0aXBzLndhcm5pbmcoIuiOt+WPluWOhuWPsuWksei0pSwg6K+35Yi35paw6aG16Z2i77yBIik7CgkJCQkJfQoJCQkJCXRoaXMuJHRpcHMud2FybmluZygi6I635Y+W5Y6G5Y+y5aSx6LSlIik7CgkJCQkJcmV0dXJuCgkJCQl9CgkJCQlyZXMuRGF0YS5EYXRhLmZvckVhY2goaXRlbSA9PiB7CgkJCQkJbGV0IG9iaiA9IEpTT04ucGFyc2UoaXRlbS5Db250ZW50KQoJCQkJCW9iai5EYXRhLk1lc3NhZ2UgPSBKU09OLnBhcnNlKG9iai5EYXRhLk1lc3NhZ2UpCgkJCQkJdGhpcy5jaGFydHNIaXN0b3J5LnVuc2hpZnQob2JqKQoJCQkJfSk7CgkJCQl0aGlzLmlzTG9hZGluZyA9IGZhbHNlCgkJCQlpZiAocmVzLkRhdGEuRGF0YS5sZW5ndGggPiAwKSB7CgkJCQkJdGhpcy4kbmV4dFRpY2soKCkgPT4gewoJCQkJCQlsZXQgbXNnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLWNoYXJ0JykgLy8g6I635Y+W5a+56LGhCgkJCQkJCW1zZy5zY3JvbGxUb3AgPSBtc2cuc2Nyb2xsSGVpZ2h0IC8vIOa7muWKqOmrmOW6pgoJCQkJCX0pCgkJCQl9CgkJCQkvLyBjb25zb2xlLmxvZyhyZXMpOwoJCQl9LAoJCQkvLyDojrflj5blvZPliY3lrqLmiLcgCgkJCWdldEN1cnJlbnRDdXN0b21lcihpdGVtLGluZGV4KXsKCQkJCS8vIOiuvue9ruiupOmihuaMiemSruWPr+ingQoJCQkJaWYgKCFpdGVtLkNoYXJ0Um9vbUd1aWQgfHwgaXRlbS5DaGFydFJvb21HdWlkLmxlbmd0aCA9PSAwKSB7CgkJCQkJdGhpcy5pc0J1dHRvbiA9IHRydWUKCQkJCX1lbHNlIHsKCQkJCQl0aGlzLmlzQnV0dG9uID0gZmFsc2UKCQkJCX0KCQkJCXRoaXMuaXNBY3RpdmUgPSBpbmRleDsKCQkJCXRoaXMuY3VycmVudCA9IGl0ZW07CgkJCQkvLyBjb25zb2xlLmxvZyh0aGlzLmN1cnJlbnQpOwoJCQkJLy8g5riF56m66IGK5aSp5pWw5o2u77yM5Yi35paw6K+35rGC5Y6G5Y+y6aG15pWwCgkJCQl0aGlzLmNoYXJ0c0hpc3RvcnkgPSBbXTsKCQkJCXRoaXMuaGlzdG9yeVBhZ2VJbmRleCA9IDA7CgkJCQlpZihpdGVtLlR5cGUgIT0gImNhbmRpZGF0ZSIpewoJCQkJCS8vZ2V0IGNoYXJ0cyBoaXN0b3J5CgkJCQkJdGhpcy5nZXRIaXN0b3J5SW5mbygpCgkJCQl9CgkJCX0sCgkJCS8vIOiupOmihgoJCQlhc3luYyBjb25uZWN0aW9uKCl7CgkJCQl0aGlzLmlzQnV0dG9uID0gZmFsc2UKCQkJCWxldCBwYXJhbXMgPSB7CgkJCQkJVG9rZW46IHRoaXMubm90aWNlRXguaW5mby50b2tlbiwKCQkJCQlVc2VyR3VpZDogdGhpcy5jdXJyZW50LlVzZXJHdWlkLAoJCQkJCVVzZXJOYW1lOiB0aGlzLmN1cnJlbnQuVXNlck5hbWUsCgkJCQkJQ2hhcnRSb29tTmFtZTogIuS4jiIrdGhpcy5jdXJyZW50LlVzZXJOYW1lKyLnmoTogYrlpKkiLAoJCQkJCUFwcElkOiAiIiwKCQkJCX0KCQkJCWxldCByZXMgPSBhd2FpdCB0aGlzLm5vdGljZUV4Lm5vdGljZUdldCgiL2NoYXJ0L2Nvbm5lY3Rpb24iLCBwYXJhbXMpCgkJCQlpZighcmVzLlN1Y2Nlc3MpewoJCQkJCXRoaXMuJHRpcHMud2FybmluZygi6K6k6aKG6ZSZ6K+vIik7CgkJCQkJdGhpcy5pc0J1dHRvbiA9IHRydWUKCQkJCQlyZXR1cm4KCQkJCX0KCQkJCXRoaXMuY3VycmVudC5DaGFydFJvb21HdWlkID0gcmVzLkRhdGEuQ2hhcnRSb29tR3VpZDsKCgkJCQlsZXQgc2VuZGVyID0gdGhpcy5nZXRTZW5kZXIoKQoJCQkJc2VuZGVyLkZyb20uR3VpZCA9ICIiOwoJCQkJc2VuZGVyLkZyb20uTmFtZSA9ICIiOwoJCQkJc2VuZGVyLkRhdGEuTWVzc2FnZSA9IHsKCQkJCQlUeXBlOiAic3lzIiwKCQkJCQlDb250ZW50OiAi5oKo5bey6K6k6aKG5LiOIit0aGlzLmN1cnJlbnQuVXNlck5hbWUrIueahOayn+mAmiIsCgkJCQl9CgkJCQl0aGlzLmNoYXJ0c0hpc3RvcnkucHVzaChzZW5kZXIpCgkJCX0sCgkJCWFzeW5jIHJlZ2lzdGVyQ3VzdG9tZXJTZXJ2ZSgpewoJCQkJbGV0IHBhcmFtcyA9IHsKCQkJCQlUb2tlbjogdGhpcy5ub3RpY2VFeC5pbmZvLnRva2VuLAoJCQkJCVJvbGU6IDIgLy8gMHwyIOWuouaIt3zlrqLmnI0KCQkJCX0KCQkJCWxldCByZXMgPSBhd2FpdCB0aGlzLm5vdGljZUV4Lm5vdGljZUdldCgiL2NoYXJ0L3NldHJvbGUiLCBwYXJhbXMpCgkJCQlpZighcmVzLlN1Y2Nlc3MpewoJCQkJCWlmKHJlcy5Db2RlID09IDExMDEpewoJCQkJCQl0aGlzLiR0aXBzLndhcm5pbmcoIumTvuaOpeW3suaWreW8gO+8jOivt+WwneivleWIt+aWsOmhtemdoiEiKTsKCQkJCQl9CgkJCQkJcmV0dXJuCgkJCQl9CgkJCX0sCgkJCS8vIOaWreW8gOi/nuaOpQoJCQlhc3luYyBzdG9wU2Vzc2lvbiAoKSB7CgkJCQlsZXQgcGFyYW1zID0gewoJCQkJCVRva2VuOiB0aGlzLm5vdGljZUV4LmluZm8udG9rZW4sCgkJCQkJQ2hhcnRSb29tR3VpZDogdGhpcy5jdXJyZW50LkNoYXJ0Um9vbUd1aWQKCQkJCX0KCQkJCWxldCByZXMgPSBhd2FpdCB0aGlzLm5vdGljZUV4Lm5vdGljZUdldCgiL2NoYXJ0L3NldHNlcnZlcmVuZCIsIHBhcmFtcykKCQkJCWlmKCFyZXMuU3VjY2Vzcyl7CgkJCQkJdGhpcy4kdGlwcy53YXJuaW5nKCLnu5PmnZ/plJnor6/vvIzor7flsJ3or5XliLfmlrDpobXpnaLvvIEiKTsKCQkJCX0KCQkJCS8vIOa4heepulJvb21HdWlkCgkJCQl0aGlzLmN1cnJlbnQuQ2hhcnRSb29tR3VpZCA9ICIiCgkJCQl0aGlzLmNhbmRpZGF0ZSA9IFtdCgkJCQl0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIG1lc3NhZ2U6ICfmnKzmrKHmnI3liqHlt7Lnu5PmnZ/vvIEnLAogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCgkJCQl9KTsKCQkJCXRoaXMuZ2V0SGlzdG9yeUN1c3RvbWVyKCkKCQkJCXRoaXMuZ2V0Q2FuZGlkYXRlTGlzdCgpCgkJCX0sCgkJCS8vIOa7muWKqOadoeaLieW6lQoJCQltYXhTY3JvbGxUb3AoKSB7CgkJCQl0aGlzLiRuZXh0VGljaygoKSA9PiB7CgkJCQkJbGV0IG1zZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1jaGFydCcpIC8vIOiOt+WPluWvueixoQoJCQkJCW1zZy5zY3JvbGxUb3AgPSBtc2cuc2Nyb2xsSGVpZ2h0IC8vIOa7muWKqOmrmOW6pgoJCQkJfSkKCQkJfSwKCQkJLy8g55uR5ZCs5rua5Yqo5LqL5Lu2CgkJCXNjcm9sbEV2ZW50KGUpewoJCQkJLy8gY29uc29sZS5sb2coZS5zcmNFbGVtZW50LnNjcm9sbFRvcCkKCQkJCWlmIChlLnNyY0VsZW1lbnQuc2Nyb2xsVG9wID09IDApIHsKCQkJCQl0aGlzLmxvZ2RpbmcoKQoJCQkJfQoJCQl9LAoJCQkvLyDliqDovb3mm7TlpJrljoblj7LorrDlvZUKCQkJbG9nZGluZygpIHsKCQkJCXRoaXMuaGlzdG9yeVBhZ2VJbmRleCArPSAxCgkJCQl0aGlzLmdldEhpc3RvcnlJbmZvKCkKCQkJfQoJCX0sCgkJY3JlYXRlZCgpIHsKCQkJdGhpcy52aWV3LnRhYmxlSGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0LzEwMCAqIDc1OwoJCX0sCgkJbW91bnRlZCgpIHsKCQkJLy9jb25zb2xlLmxvZyh0aGlzLm5vdGljZUV4KQoJCQlzZXRUaW1lb3V0KCgpPT57CgkJCQl0aGlzLnJlZ2lzdGVyQ3VzdG9tZXJTZXJ2ZSgpCgkJCQl0aGlzLmdldEhpc3RvcnlDdXN0b21lcigpCgkJCQl0aGlzLmdldENhbmRpZGF0ZUxpc3QoKQoJCQl9LDEwMDApCgkJCQoJCQl0aGlzLiRldmVuLiRvbigibm90aWNlX2NzX2luZm8iLChpbmZvKT0+ewoJCQkJbGV0IGNvbnRlbnQgPSBpbmZvLkRhdGEuTWVzc2FnZTsKCQkJCWNvbnNvbGUubG9nKGNvbnRlbnQpOwoJCQkJc3dpdGNoKGNvbnRlbnQuVHlwZSkgewoJCQkJCWNhc2UgImNhbmRpZGF0ZSI6IC8vIOW+heaOpempswoJCQkJCQlpZih0aGlzLmNhbmRpZGF0ZS5maW5kSW5kZXgoaXRlbSA9PiBpdGVtLlVzZXJHdWlkID09PSBjb250ZW50LlVzZXJHdWlkKSA9PSAtMSkgeyAvLyDljrvph40KCQkJCQkJCXRoaXMuY2FuZGlkYXRlLnB1c2goY29udGVudCk7CgkJCQkJCQkvLyBjb25zb2xlLmxvZyh0aGlzLmNhbmRpZGF0ZSk7CgkJCQkJCX1lbHNlIHsKCQkJCQkJCXRoaXMuY2FuZGlkYXRlLnNwbGljZSh0aGlzLmNhbmRpZGF0ZS5maW5kSW5kZXgoaXRlbSA9PiBpdGVtLlVzZXJHdWlkID09PSBjb250ZW50LlVzZXJHdWlkKSwgMSwgY29udGVudCkgLy8g5YiX6KGo5bey5a2Y5Zyo5YiZ5pu/5o2iCgkJCQkJCX0KCQkJCQkJYnJlYWs7CgkJCQkJY2FzZSAiaW5mbyI6IC8vIOa2iOaBrwoJCQkJCQl0aGlzLmNoYXJ0c0hpc3RvcnkucHVzaChpbmZvKTsKCQkJCQkJdGhpcy5tYXhTY3JvbGxUb3AoKTsKCQkJCQkJYnJlYWs7CgkJCQkJY2FzZSAic3lzIjogLy8g5raI5oGvCgkJCQkJCWluZm8uRGF0YS5NZXNzYWdlLkNvbnRlbnQ9dGhpcy5TeXNNZXNzYWdlQ29udGVudERpY1tpbmZvLkRhdGEuTWVzc2FnZS5Db250ZW50XTsKCQkJCQkJdGhpcy5jaGFydHNIaXN0b3J5LnB1c2goaW5mbyk7CgkJCQkJCXRoaXMubWF4U2Nyb2xsVG9wKCk7CgkJCQkJCWJyZWFrOwoJCQkJCWNhc2UgImNvbm5lY3RlZCI6IC8vIOiiq+aOpempswoJCQkJCQkvLyBjb25zb2xlLmxvZygn6KKr5o6l6amzJyxjb250ZW50KTsKCQkJCQkJdGhpcy4kbWVzc2FnZShjb250ZW50LnVzZXIuTmFtZSwn5bey57uP6KKr5o6l6amzIScpOwoJCQkJCQkvLyBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY2FuZGlkYXRlLmxlbmd0aDsgaSsrKSB7CgkJCQkJCS8vIAlpZih0aGlzLmNhbmRpZGF0ZVtpXS5Vc2VyR3VpZCA9PSBjb250ZW50LlVzZXJHdWlkKSB7CgkJCQkJCS8vIAkJcmV0dXJuIGkKCQkJCQkJLy8gCX0KCQkJCQkJLy8gfQoJCQkJCQl0aGlzLmNhbmRpZGF0ZS5zcGxpY2UodGhpcy5jYW5kaWRhdGUuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS5Vc2VyR3VpZCA9PSBjb250ZW50LlVzZXJHdWlkKSwgMSkvLyDliKDpmaQKCQkJCQkJYnJlYWs7CgkJCQl9IAoJCQl9KQoJCX0KCX0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"pages/main/im","sourcesContent":["<template>\r\n\t\t<el-row class=\"main\" :style=\"{'height':view.tableHeight + 'px'}\">\r\n\t\t\t<el-col :span=\"24\" style=\"height:100%;\">\r\n\t\t\t\t<el-row type=\"flex\" style=\"height:100%;\">\r\n\t\t\t\t\t<!-- 咨询列表 -->\r\n\t\t\t\t\t<el-col :span=\"5\" style=\"height:100%; background-color: #f8fafb;\">\r\n\t\t\t\t\t\t<el-row :span=\"24\">\r\n\t\t\t\t\t\t\t<p class=\"search\">\r\n\t\t\t\t\t\t\t\t<!-- <el-input\r\n\t\t\t\t\t\t\t\t\tsize=\"mini\"\r\n\t\t\t\t\t\t\t\t\tplaceholder=\"搜索\">\r\n\t\t\t\t\t\t\t\t\t<i slot=\"suffix\" class=\"el-input__icon el-icon-search\"></i>\r\n\t\t\t\t\t\t\t\t</el-input> -->\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t<!-- 咨询列表项 -->\r\n\t\t\t\t\t\t\t<el-scrollbar style=\"height:625px; overflow-x: hidden;\">\r\n\t\t\t\t\t\t\t\t<div :class=\"['user-lists', isActive==index?'isActive':'']\" @click=\"getCurrentCustomer(item,index)\" v-for=\"(item,index) in candidate\" :key=\"item.UserGuid\" style=\"height:80px\">\r\n\t\t\t\t\t\t\t\t\t<el-avatar :size=\"40\" style=\"background-color:#00b280;\">{{ item.UserName.substr(0,1) }}</el-avatar>\r\n\t\t\t\t\t\t\t\t\t<span>{{ item.UserName }}</span>\r\n\t\t\t\t\t\t\t\t\t<span v-if=\"item.ChartRoomGuid && item.ChartRoomGuid.length > 0\" style=\"color: #42B983\">(正在服务..)</span>\r\n\t\t\t\t\t\t\t\t\t<span v-if=\"!item.ChartRoomGuid || item.ChartRoomGuid.length == 0\" style=\"color: #fa2541\">(待服务)</span>\r\n\t\t\t\t\t\t\t\t\t<!-- <span class=\"user-lists-date\">{{ item.CreateDate.substr(11,5) }}</span> -->\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div :class=\"['user-lists']\" @click=\"getCurrentCustomer(item)\" v-for=\"item in historyCustomer\" :key=\"item.ChartRoomGuid\" style=\"height:80px\">\r\n\t\t\t\t\t\t\t\t\t<el-avatar :size=\"40\" style=\"background-color:#00b280;\">{{ item.ChartRoomName.substr(1,1) }}</el-avatar>\r\n\t\t\t\t\t\t\t\t\t<span>{{ item.ChartRoomName }}</span>\r\n\t\t\t\t\t\t\t\t\t<span v-if=\"item.UserAuth == 0\" style=\"color: #ccc\">(已结束)</span>\r\n\t\t\t\t\t\t\t\t\t<span class=\"user-lists-date\">{{ item.CreateDate.substr(11,5) }} </span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</el-scrollbar>\r\n\t\t\t\t\t\t</el-row>\r\n\t\t\t\t\t</el-col>\t\r\n\t\t\t\t\t<!-- 消息窗口 -->\r\n\t\t\t\t\t<el-col :span=\"19\"\r\n\t\t\t\t\t\t\t\t\tstyle=\"height:100%;\"\r\n\t\t\t\t\t\t\t\t\tclass=\"message-content\"\r\n\t\t\t\t\t\t\t\t\tv-if=\"current.ChartRoomGuid||current.Type == 'candidate'\">\r\n\t\t\t\t\t\t<div style=\"height:100%\">\r\n\t\t\t\t\t\t\t<div class=\"get-user\">\r\n\t\t\t\t\t\t\t\t<span>{{ current.UserName || \"\" || current.ChartRoomName }}</span>\r\n\t\t\t\t\t\t\t\t<!-- 判断会话是否结束 -->\r\n\t\t\t\t\t\t\t\t<el-button\r\n\t\t\t\t\t\t\t\t\ttype=\"danger\"\r\n\t\t\t\t\t\t\t\t\tsize=\"mini\" round\r\n\t\t\t\t\t\t\t\t\t@click=\"stopSession\"\r\n\t\t\t\t\t\t\t\t\tv-if=\"current.UserAuth==2 || current.ChartRoomGuid && current.ChartRoomGuid.length>0 && current.UserAuth !==2 && current.UserAuth !==0\">\r\n\t\t\t\t\t\t\t\t\t<!-- :plain=\"current.UserAuth==0||current.ChartRoomGuid?true:false\" -->\r\n\t\t\t\t\t\t\t\t\t<!-- :disabled=\"current.UserAuth==0||current.ChartRoomGuid?true:false\" -->\r\n\t\t\t\t\t\t\t\t\t结束本次服务</el-button>\r\n\t\t\t\t\t\t\t\t<el-button v-if=\"isButton\" @click=\"connection()\" type=\"primary\">认领</el-button>\t\t\t \r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<!-- 对话框 监听滚动事件 -->\r\n\t\t\t\t\t\t\t<div id=\"scrollEvent\" class=\"dialog js-chart\" style=\"height:65%; overflow-y: scroll;\" @scroll=\"scrollEvent\" v-loading=\"isLoading\">\r\n\t\t\t\t\t\t\t\t<!--  @scroll=\"scrollEvent\" -->\r\n\t\t\t\t\t\t\t\t<div v-for=\"(item,index) in chartsHistory\" :key=\"index\" style=\"height:auto; margin: 0 auto 20px; text-align: center\">\r\n\t\t\t\t\t\t\t\t\t<!-- 客户 -->\r\n\t\t\t\t\t\t\t\t\t<div class=\"dialog-item\" v-if=\"item.From.Guid != noticeEx.info.user.guid && item.Data.Message.Type!='sys'\" style=\"margin:7px 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"dialog-date\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div style=\"font-size: 12px;color:#ccc; margin-bottom: 5px; padding-left: 7px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{{ item.From.Name }}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<el-avatar :size=\"40\" src=\"\">{{ item.From.Name.substr(0,1) }}</el-avatar>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"dialog-a\">\r\n\t\t\t\t\t\t\t\t\t\t\t{{ item.Data.Message.Content }}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div style=\"font-size: 12px;color:#ccc; padding-left: 5px;\">{{ item.CreateDate.substr(11,5) }}</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<!-- 系统消息 -->\r\n\t\t\t\t\t\t\t\t\t<div class=\"prompt-text\" v-if=\"item.Data.Message.Type=='sys'\" >\r\n\t\t\t\t\t\t\t\t\t\t{{ item.Data.Message.Content }}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<!-- 自己 -->\r\n\t\t\t\t\t\t\t\t\t<div class=\"dialog-item\" v-if=\"item.From.Guid == noticeEx.info.user.guid\" style=\"margin:7px 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t<div style=\"text-align: right\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div style=\"font-size: 12px; color:#ccc; margin-bottom: 5px; padding-right: 7px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t我\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<el-avatar :size=\"40\" :src=\"require('@/src/assets/images/login/logo2.png')\"></el-avatar>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"dialog-b\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{{ item.Data.Message.Content }}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div style=\"font-size: 12px;color:#ccc; padding-right: 5px;\">{{ item.CreateDate?item.CreateDate.substr(11,5):\"\" }}</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"img-click\">\r\n\t\t\t\t\t\t\t\t<!-- <el-popover\r\n\t\t\t\t\t\t\t\t\tplacement=\"top\"\r\n\t\t\t\t\t\t\t\t\twidth=\"20px\"\r\n\t\t\t\t\t\t\t\t\ttrigger=\"click\">\r\n\t\t\t\t\t\t\t\t\t<span>敬请期待</span>\r\n\t\t\t\t\t\t\t\t\t<i slot=\"reference\" class=\"el-icon-picture-outline\" style=\"cursor: pointer;\"></i>\r\n\t\t\t\t\t\t\t\t</el-popover> -->\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"input-content\">\r\n\t\t\t\t\t\t\t\t<textarea \r\n\t\t\t\t\t\t\t\t\tv-model=\"sendText\"\r\n\t\t\t\t\t\t\t\t\t@keydown=\"addByEnterKey\">\r\n\t\t\t\t\t\t\t\t</textarea>\r\n\t\t\t\t\t\t\t\t<el-button\r\n\t\t\t\t\t\t\t\t\tsize=\"mini\"\r\n\t\t\t\t\t\t\t\t\t@click=\"sendInfo()\" \r\n\t\t\t\t\t\t\t\t\ttype=\"primary\">发送</el-button>\r\n\t\t\t\t\t\t\t\t<!-- <el-button @click=\"sendText = ''\"  size=\"mini\"  icon=\"el-icon-delete\" circle style=\"float: right;padding: 10px 0\"></el-button> -->\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\t\t\t\r\n\t\t\t\t\t</el-col>\r\n\t\t\t\t</el-row>\r\n\t\t\t</el-col>\r\n\t\t</el-row>\r\n\t\r\n</template>\r\n\r\n<script>\r\n\timport {mapState,mapMutations} from 'vuex'\r\n\tlet imgUrl = require('@/src/assets/images/login/logo2.png')\r\n\texport default {\r\n\t\tcomputed: {\r\n\t\t\t...mapState([\"noticeEx\"]),\r\n\t\t},\r\n\t\tdata(){\r\n\t\t\treturn {\r\n\t\t\t\tisActive: \"-1\",\r\n\t\t\t\tisButton: false,\r\n\t\t\t\tisLoading: false,\r\n\t\t\t\tsendText: \"\",// 输入文字\r\n\t\t\t\tcurrent: {},// 当前用户信息\r\n\t\t\t\tchartsHistory: [], // 消息\r\n\t\t\t\tcandidate: [], // 待接驳\r\n\t\t\t\thasCandidate: [], // 被其他客服接驳\r\n\t\t\t\thistoryCustomer: [], // 已经接驳\r\n\t\t\t\thistoryPageIndex: 0, // 历史记录查询页数0开始\r\n\t\t\t\thistoryPageSize: 9, // 历史记录查询条数\r\n\t\t\t\turl: imgUrl, // 默认系统头像\r\n\t\t\t\tview: {\r\n\t\t\t\t\ttableHeight: 650\r\n\t\t\t\t},\r\n\t\t\t\tSysMessageContentDic:{//系统通知内容对照\r\n\t\t\t\t\t'MedicalChartRoom_Quit':'客户已退出聊天，系统已为您切换到留言模式！在\"结束服务\"前，您的消息将通过留言的方式，发给送客户。'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods:{\r\n\t\t\tgetSender(){\r\n\t\t\t\treturn {\r\n\t\t\t\t\t\"Token\":this.noticeEx.info.token,\r\n\t\t\t\t\t\"Type\":\"app\",\r\n\t\t\t\t\t\"From\":{\r\n\t\t\t\t\t\t\"Name\":this.noticeEx.info.user.name,\r\n\t\t\t\t\t\t\"Guid\":this.noticeEx.info.user.guid,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\"Data\":{\r\n\t\t\t\t\t\t\"Message\":\"\",\r\n\t\t\t\t\t\t\"Accept\":{\r\n\t\t\t\t\t\t\t\"Guid\":\"\"\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\"Type\":\"cs\"\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync getCandidateList() {\r\n\t\t\t\tlet res = await this.noticeEx.noticeGet(\"/chart/getcandidate\", {Token: this.noticeEx.info.token})\r\n\t\t\t\tconsole.log(res);\r\n\t\t\t\tif(!res.Success){\r\n\t\t\t\t\tthis.$tips.warning(\"获取带接驳客户失败\");\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tthis.candidate = res.Data\r\n\t\t\t},\r\n\t\t\t// 发送\r\n\t\t\tsendInfo() {\r\n\t\t\t\t// 先判断是否为空 \r\n\t\t\t\tif(this.sendText !== \"\") {\r\n\t\t\t\t\t// 会话已经结束 || 待接驳状态，发系统消息提示并执行滚动、清空文本框\r\n\t\t\t\t\tif (this.current.UserAuth == 0||!this.current.ChartRoomGuid || this.current.ChartRoomGuid.length == 0) {\r\n\t\t\t\t\t\tlet sender = this.getSender()\r\n\t\t\t\t\t\tsender.From.Guid = \"\";\r\n\t\t\t\t\t\tsender.From.Name = \"\";\r\n\t\t\t\t\t\tsender.Data.Message = {\r\n\t\t\t\t\t\t\tType: \"sys\",\r\n\t\t\t\t\t\t\tContent: \"发送失败，当前不能发送消息！\",\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.chartsHistory.push(sender)\r\n\t\t\t\t\t\tthis.maxScrollTop();\r\n\t\t\t\t\t\tthis.sendText = '';\r\n\t\t\t\t\t\t// console.log(this.chartsHistory);\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 认领完后 或者 历史认领没有结束会话可发送\r\n\t\t\t\t\t// 发送服务\r\n\t\t\t\t\tlet sender = this.getSender() // 格式化\r\n\t\t\t\t\tsender.Data.Accept.Guid =this.current.ChartRoomGuid;\r\n\t\t\t\t\tsender.Data.Message = JSON.stringify({Type:\"info\",Content:this.sendText});\r\n\t\t\t\t\t// 显示在窗口假信息\r\n\t\t\t\t\tlet ms = this.getSender()\r\n\t\t\t\t\tms.Data.Accept.Guid =this.current.ChartRoomGuid;\r\n\t\t\t\t\tms.Data.Message = {\r\n\t\t\t\t\t\tType: \"info\",\r\n\t\t\t\t\t\tContent: this.sendText\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.chartsHistory.push(ms);\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tthis.noticeEx.sendSocure(sender); // 传输\r\n\t\t\t\t\t}catch(e){\r\n\t\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.sendText = '';\r\n\t\t\t\t\tthis.maxScrollTop();\r\n\t\t\t\t}else {\r\n\t\t\t\t\tthis.$tips.warning(\"请输入消息\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 键盘监听事件\r\n\t\t\taddByEnterKey(e) {\r\n\t\t\t\t// 删除默认事件 取消回车换行\r\n\t\t\t\t// e.preventDefault()\r\n\t\t\t\tif (e.keyCode == 13) {\r\n\t\t\t\t\tthis.sendInfo()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync getHistoryCustomer() {\r\n\t\t\t\tlet res = await this.noticeEx.noticeGet(\"/chart/getuserchartrooms\", {Token: this.noticeEx.info.token})\r\n\t\t\t\tthis.historyCustomer = res.Data\r\n\t\t\t\tif(!res.Success){\r\n\t\t\t\t\tthis.$tips.warning(\"获取房间失败\");\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t// console.log(res);\r\n\t\t\t},\r\n\t\t\t// 历史记录\r\n\t\t\tasync getHistoryInfo() {\r\n\t\t\t\tthis.isLoading = true\r\n\t\t\t\tlet params = {\r\n\t\t\t\t\tToken: this.noticeEx.info.token,\r\n\t\t\t\t\tPageIndex: this.historyPageIndex,\r\n\t\t\t\t\tPageSize: this.historyPageSize,\r\n\t\t\t\t\tChartRoomGuid: this.current.ChartRoomGuid\r\n\t\t\t\t}\r\n\t\t\t\tlet res = await this.noticeEx.noticeGet(\"/chart/getchartroomhistoryinfo\", params)\r\n\t\t\t\tif(!res.Success){\r\n\t\t\t\t\tif (res.Code == 1101) {\r\n\t\t\t\t\t\tthis.$tips.warning(\"获取历史失败, 请刷新页面！\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.$tips.warning(\"获取历史失败\");\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tres.Data.Data.forEach(item => {\r\n\t\t\t\t\tlet obj = JSON.parse(item.Content)\r\n\t\t\t\t\tobj.Data.Message = JSON.parse(obj.Data.Message)\r\n\t\t\t\t\tthis.chartsHistory.unshift(obj)\r\n\t\t\t\t});\r\n\t\t\t\tthis.isLoading = false\r\n\t\t\t\tif (res.Data.Data.length > 0) {\r\n\t\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t\tlet msg = document.querySelector('.js-chart') // 获取对象\r\n\t\t\t\t\t\tmsg.scrollTop = msg.scrollHeight // 滚动高度\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\t// console.log(res);\r\n\t\t\t},\r\n\t\t\t// 获取当前客户 \r\n\t\t\tgetCurrentCustomer(item,index){\r\n\t\t\t\t// 设置认领按钮可见\r\n\t\t\t\tif (!item.ChartRoomGuid || item.ChartRoomGuid.length == 0) {\r\n\t\t\t\t\tthis.isButton = true\r\n\t\t\t\t}else {\r\n\t\t\t\t\tthis.isButton = false\r\n\t\t\t\t}\r\n\t\t\t\tthis.isActive = index;\r\n\t\t\t\tthis.current = item;\r\n\t\t\t\t// console.log(this.current);\r\n\t\t\t\t// 清空聊天数据，刷新请求历史页数\r\n\t\t\t\tthis.chartsHistory = [];\r\n\t\t\t\tthis.historyPageIndex = 0;\r\n\t\t\t\tif(item.Type != \"candidate\"){\r\n\t\t\t\t\t//get charts history\r\n\t\t\t\t\tthis.getHistoryInfo()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 认领\r\n\t\t\tasync connection(){\r\n\t\t\t\tthis.isButton = false\r\n\t\t\t\tlet params = {\r\n\t\t\t\t\tToken: this.noticeEx.info.token,\r\n\t\t\t\t\tUserGuid: this.current.UserGuid,\r\n\t\t\t\t\tUserName: this.current.UserName,\r\n\t\t\t\t\tChartRoomName: \"与\"+this.current.UserName+\"的聊天\",\r\n\t\t\t\t\tAppId: \"\",\r\n\t\t\t\t}\r\n\t\t\t\tlet res = await this.noticeEx.noticeGet(\"/chart/connection\", params)\r\n\t\t\t\tif(!res.Success){\r\n\t\t\t\t\tthis.$tips.warning(\"认领错误\");\r\n\t\t\t\t\tthis.isButton = true\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tthis.current.ChartRoomGuid = res.Data.ChartRoomGuid;\r\n\r\n\t\t\t\tlet sender = this.getSender()\r\n\t\t\t\tsender.From.Guid = \"\";\r\n\t\t\t\tsender.From.Name = \"\";\r\n\t\t\t\tsender.Data.Message = {\r\n\t\t\t\t\tType: \"sys\",\r\n\t\t\t\t\tContent: \"您已认领与\"+this.current.UserName+\"的沟通\",\r\n\t\t\t\t}\r\n\t\t\t\tthis.chartsHistory.push(sender)\r\n\t\t\t},\r\n\t\t\tasync registerCustomerServe(){\r\n\t\t\t\tlet params = {\r\n\t\t\t\t\tToken: this.noticeEx.info.token,\r\n\t\t\t\t\tRole: 2 // 0|2 客户|客服\r\n\t\t\t\t}\r\n\t\t\t\tlet res = await this.noticeEx.noticeGet(\"/chart/setrole\", params)\r\n\t\t\t\tif(!res.Success){\r\n\t\t\t\t\tif(res.Code == 1101){\r\n\t\t\t\t\t\tthis.$tips.warning(\"链接已断开，请尝试刷新页面!\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 断开连接\r\n\t\t\tasync stopSession () {\r\n\t\t\t\tlet params = {\r\n\t\t\t\t\tToken: this.noticeEx.info.token,\r\n\t\t\t\t\tChartRoomGuid: this.current.ChartRoomGuid\r\n\t\t\t\t}\r\n\t\t\t\tlet res = await this.noticeEx.noticeGet(\"/chart/setserverend\", params)\r\n\t\t\t\tif(!res.Success){\r\n\t\t\t\t\tthis.$tips.warning(\"结束错误，请尝试刷新页面！\");\r\n\t\t\t\t}\r\n\t\t\t\t// 清空RoomGuid\r\n\t\t\t\tthis.current.ChartRoomGuid = \"\"\r\n\t\t\t\tthis.candidate = []\r\n\t\t\t\tthis.$message({\r\n          message: '本次服务已结束！',\r\n          type: 'success'\r\n\t\t\t\t});\r\n\t\t\t\tthis.getHistoryCustomer()\r\n\t\t\t\tthis.getCandidateList()\r\n\t\t\t},\r\n\t\t\t// 滚动条拉底\r\n\t\t\tmaxScrollTop() {\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tlet msg = document.querySelector('.js-chart') // 获取对象\r\n\t\t\t\t\tmsg.scrollTop = msg.scrollHeight // 滚动高度\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 监听滚动事件\r\n\t\t\tscrollEvent(e){\r\n\t\t\t\t// console.log(e.srcElement.scrollTop)\r\n\t\t\t\tif (e.srcElement.scrollTop == 0) {\r\n\t\t\t\t\tthis.logding()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 加载更多历史记录\r\n\t\t\tlogding() {\r\n\t\t\t\tthis.historyPageIndex += 1\r\n\t\t\t\tthis.getHistoryInfo()\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.view.tableHeight = window.innerHeight/100 * 75;\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\t//console.log(this.noticeEx)\r\n\t\t\tsetTimeout(()=>{\r\n\t\t\t\tthis.registerCustomerServe()\r\n\t\t\t\tthis.getHistoryCustomer()\r\n\t\t\t\tthis.getCandidateList()\r\n\t\t\t},1000)\r\n\t\t\t\r\n\t\t\tthis.$even.$on(\"notice_cs_info\",(info)=>{\r\n\t\t\t\tlet content = info.Data.Message;\r\n\t\t\t\tconsole.log(content);\r\n\t\t\t\tswitch(content.Type) {\r\n\t\t\t\t\tcase \"candidate\": // 待接驳\r\n\t\t\t\t\t\tif(this.candidate.findIndex(item => item.UserGuid === content.UserGuid) == -1) { // 去重\r\n\t\t\t\t\t\t\tthis.candidate.push(content);\r\n\t\t\t\t\t\t\t// console.log(this.candidate);\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tthis.candidate.splice(this.candidate.findIndex(item => item.UserGuid === content.UserGuid), 1, content) // 列表已存在则替换\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"info\": // 消息\r\n\t\t\t\t\t\tthis.chartsHistory.push(info);\r\n\t\t\t\t\t\tthis.maxScrollTop();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"sys\": // 消息\r\n\t\t\t\t\t\tinfo.Data.Message.Content=this.SysMessageContentDic[info.Data.Message.Content];\r\n\t\t\t\t\t\tthis.chartsHistory.push(info);\r\n\t\t\t\t\t\tthis.maxScrollTop();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"connected\": // 被接驳\r\n\t\t\t\t\t\t// console.log('被接驳',content);\r\n\t\t\t\t\t\tthis.$message(content.user.Name,'已经被接驳!');\r\n\t\t\t\t\t\t// for (var i = 0; i < this.candidate.length; i++) {\r\n\t\t\t\t\t\t// \tif(this.candidate[i].UserGuid == content.UserGuid) {\r\n\t\t\t\t\t\t// \t\treturn i\r\n\t\t\t\t\t\t// \t}\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t\tthis.candidate.splice(this.candidate.findIndex(item => item.UserGuid == content.UserGuid), 1)// 删除\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t} \r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n</script>  \r\n\r\n<style lang=\"scss\" scoped>\r\n\t.clearfix{zoom:1}\r\n\t.clearfix:after{content:\" \";display:block;clear:both;height:0}\r\n\t.is-left{width:100%}\r\n\r\n  .main {\r\n\t\tborder-radius:7px; \r\n\t\tbox-shadow: 0 0 8px rgb(237, 244, 246), 0 0 8px rgb(237, 244, 246); \r\n\t}\r\n\r\n\t.search {\r\n\t\theight: 25px;\r\n\t\tpadding: 10px;\r\n\t\t.el-input {\r\n\t\t\tborder-right: 20px;\r\n\t\t} \r\n\t}\r\n\r\n\t.user-lists {\r\n\t\tpadding-left: 15px;\r\n\t\tposition: relative;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tfont-size: 12px;\r\n\t\t.el-avatar {\r\n\t\t\tmargin: 0 5px;\r\n\t\t}\r\n\t\t.user-lists-date {\r\n\t\t\tposition: absolute;\r\n\t\t\ttop: 20px;\r\n\t\t\tright: 20px;\r\n\t\t\tcolor:#ccc;\r\n\t\t}\r\n\t}\r\n\r\n\t.user-lists:hover {\r\n\t\tbackground-color: #eaf1f4;\r\n\t\tcursor: pointer;\r\n\t}\r\n\r\n\t.isActive {\r\n\t\tbackground-color: #ecf5ff;\r\n\t}\r\n\t.get-user {\r\n\t\theight: 75px;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tpadding: 0 20px;\r\n\t\tbackground-color: #ffffff;\r\n\t\tborder-bottom: 2px solid #fafbfc;\r\n\t\tspan {\r\n\t\t\tcolor: black;\r\n\t\t}\r\n\t\t.el-button {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\theight: 30px;\r\n\t\t}\r\n\t}\r\n\r\n\t.dialog {\r\n\t\tbackground: #ffffff; \r\n\t\tpadding: 15px; \r\n\t\tborder-radius: 0 0 4px 4px;\r\n\t\t.dialog-item {\r\n\t\t\tposition: relative;\r\n\t\t\ttext-align: left;\r\n\t\t\t.dialog-a {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: 25px;\r\n\t\t\t\tleft: 55px;\r\n\t\t\t\tbackground: #d3e4ea; \r\n\t\t\t\tcolor: black; \r\n\t\t\t\tpadding: 6px 10px; \r\n\t\t\t\tdisplay: inline-block; \r\n\t\t\t\tbox-shadow: 0px 1px 7px -5px #000;\r\n\t\t\t\tborder: 0px solid #000;\r\n\t\t\t\tmax-width: calc(45%);\r\n\t\t\t\tword-wrap: break-word;\r\n\t\t\t}\r\n\t\t\t.dialog-b {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: 25px;\r\n\t\t\t\tright: 55px;\r\n\t\t\t\tbackground: #6ea5ba; \r\n\t\t\t\tcolor: white; \r\n\t\t\t\tpadding: 6px 10px; \r\n\t\t\t\tdisplay: inline-block; \r\n\t\t\t\tbox-shadow: 0px 1px 7px -5px #000;\r\n\t\t\t\tborder:0px solid #000;\r\n\t\t\t\tmax-width: calc(45%);\r\n\t\t\t\tword-wrap: break-word;\r\n\t\t\t\ttext-align: left;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t.prompt-text {\r\n\t\t\tdisplay: inline-block;\r\n\t\t\tpadding: 4px 20px;\r\n\t\t\tbackground-color: #c0c4cc;\r\n\t\t\tcolor:#ffffff;\r\n\t\t\tfont-size: 10px;\r\n\t\t\ttext-align: center;\r\n\t\t\tborder-radius: 20px;\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\t.img-click {\r\n\t\tpadding: 0 10px;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tbackground-color: #e9f2f5; \r\n\t\theight: 25px;\r\n\t}\r\n\r\n\t.input-content {\r\n\t\tpadding: 10px;\r\n\t\ttextarea {\r\n\t\t\tposition: relative;\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 50px;\r\n\t\t\tresize: none;\r\n\t\t\toutline:none;\r\n\t\t\tborder: 0;\r\n\t\t\t\r\n\t\t}\r\n\t\t.el-button {\r\n\t\t\tposition: absolute;\r\n\t\t\tright: 10px;\r\n\t\t\tbottom: 10px;\r\n\t\t\tfloat: right;\r\n\t\t}\r\n\t\t.el-button--primary{\r\n\t\t\tcolor: #fff;\r\n\t\t\tbackground-color: #6ea5ba;\r\n\t\t\tborder-color: #6ea5ba;\r\n\t\t}\r\n\t\t.el-button--primary:focus{\r\n\t\t\tbackground-color: #6ea5ba;\r\n\t\t\tborder-color: #6ea5ba;  \r\n\t\t}\r\n\t}\r\n</style>\r\n"]}]}