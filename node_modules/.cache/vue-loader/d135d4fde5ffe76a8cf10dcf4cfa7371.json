{"remainingRequest":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GaeaProject\\jpn_medical_web\\pages\\main\\im\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\GaeaProject\\jpn_medical_web\\pages\\main\\im\\index.vue","mtime":1595845202499},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7bWFwU3RhdGUsbWFwTXV0YXRpb25zfSBmcm9tICd2dWV4JwpleHBvcnQgZGVmYXVsdCB7Cgljb21wdXRlZDogewoJCS4uLm1hcFN0YXRlKFsibm90aWNlRXgiXSksCgl9LAoJZGF0YSgpewoJCXJldHVybiB7CgkJCXRhYlBvc2l0aW9uOiAnbGVmdCcsCgkJCWNpcmNsZVVybDogImh0dHBzOi8vY3ViZS5lbGVtZWNkbi5jb20vMy83Yy8zZWE2YmVlYzY0MzY5YzI2NDJiOTJjNjcyNmYxZXBuZy5wbmciLAoJCQlzaXplTGlzdDogWyJsYXJnZSIsICJtZWRpdW0iLCAic21hbGwiXSwKCQkJc2VuZFRleHQ6IiIsCgkJCWN1cnJlbnQ6e30sCgkJCWNoYXJ0c0hpc3Rvcnk6W10sCgkJCWNhbmRpZGF0ZTpbXSwKCQkJCgkJfQoJfSwKCW1ldGhvZHM6ewoJCWdldFNlbmRlcigpewoJCQlyZXR1cm4gewoJCQkJIlRva2VuIjp0aGlzLm5vdGljZUV4LmluZm8udG9rZW4sCgkJCQkiVHlwZSI6ImFwcCIsCgkJCQkiRnJvbSI6ewoJCQkJCSJOYW1lIjp0aGlzLm5vdGljZUV4LmluZm8udXNlci5uYW1lLAoJCQkJCSJHdWlkIjp0aGlzLm5vdGljZUV4LmluZm8udXNlci5ndWlkLAoJCQkJfSwKCQkJCSJEYXRhIjp7CgkJCQkJIk1lc3NhZ2UiOiIiLAoJCQkJCSJBY2NlcHQiOnsKCQkJCQkJIkd1aWQiOiIiCgkJCQkJfSwKCQkJCQkiVHlwZSI6ImNzIgoJCQkJfQoJCQl9CgkJfSwKCQlzZW5kSW5mbygpewoJCQl0aGlzLmNoYXJ0c0hpc3RvcnkucHVzaCh7CgkJCQlUeXBlOiJzZW5kIiwKCQkJCU1lc3NhZ2U6dGhpcy5zZW5kVGV4dCwKCQkJfSkKCQkJbGV0IHNlbmRlciA9IHRoaXMuZ2V0U2VuZGVyKCkKCQkJc2VuZGVyLkRhdGEuQWNjZXB0Lkd1aWQgPXRoaXMuY3VycmVudC5DaGFydFJvb21HdWlkOwoJCQlzZW5kZXIuRGF0YS5NZXNzYWdlID0gdGhpcy5zZW5kVGV4dDsKCQkJdHJ5ewoJCQl0aGlzLm5vdGljZUV4LnNlbmRTb2N1cmUoc2VuZGVyKTsKCQkJfWNhdGNoKGUpewoJCQkJY29uc29sZS5sb2coZSkKCQkJfQoJCQl0aGlzLnNlbmRUZXh0ID0gJyc7CgkJfSwKCQlnZXRDdXJyZW50Q3VzdG9tZXIoaXRlbSl7CgkJCXRoaXMuY3VycmVudCA9IGl0ZW07CgkJCXRoaXMuY2hhcnRzSGlzdG9yeSA9IFtdOwoJCQlpZihpdGVtLlR5cGUgIT0gImNhbmRpZGF0ZSIpewoJCQkJLy9nZXQgY2hhcnRzIGhpc3RvcnkKCQkJfQoJCX0sCgkJYXN5bmMgY29ubmVjdGlvbigpewoJCQlsZXQgcGFyYW1zID0gewoJCQkJVG9rZW46dGhpcy5ub3RpY2VFeC5pbmZvLnRva2VuLAoJCQkJVXNlckd1aWQ6dGhpcy5jdXJyZW50LlVzZXJHdWlkLAoJCQkJVXNlck5hbWU6dGhpcy5jdXJyZW50LlVzZXJOYW1lLAoJCQkJQ2hhcnRSb29tTmFtZToi5LiOIit0aGlzLmN1cnJlbnQuVXNlck5hbWUrIueahOiBiuWkqSIsCgkJCQlBcHBJZDoiIiwKCQkJfQoJCQlsZXQgcmVzID0gYXdhaXQgdGhpcy5ub3RpY2VFeC5ub3RpY2VHZXQoIi9jaGFydC9jb25uZWN0aW9uIixwYXJhbXMpCgkJCWlmKCFyZXMuU3VjY2Vzcyl7CgkJCQl0aGlzLiR0aXBzLndhcm5pbmcoIuiupOmihumUmeivryIpOwoJCQkJcmV0dXJuCgkJCX0KCQkJdGhpcy5jdXJyZW50LkNoYXJ0Um9vbUd1aWQgPSByZXMuRGF0YS5DaGFydFJvb21HdWlkOwoJCQkKCQkJdGhpcy5jaGFydHNIaXN0b3J5LnB1c2goewoJCQkJVHlwZToic3lzIiwKCQkJCU1lc3NhZ2U6IuaCqOW3suiupOmihuS4jiIrdGhpcy5jdXJyZW50LlVzZXJOYW1lKyLnmoTmsp/pgJoiLAoJCQl9KQoJCQljb25zb2xlLmxvZyhyZXMpCgkJfSwKCQlhc3luYyByZWdpc3RlckN1c3RvbWVyU2VydmUoKXsKCQkJbGV0IHBhcmFtcyA9IHsKCQkJCVRva2VuOnRoaXMubm90aWNlRXguaW5mby50b2tlbiwKCQkJCVJvbGU6MgoJCQl9CgkJCWxldCByZXMgPSBhd2FpdCB0aGlzLm5vdGljZUV4Lm5vdGljZUdldCgiL2NoYXJ0L3NldHJvbGUiLHBhcmFtcykKCQkJY29uc29sZS5sb2cocmVzKQoJCX0sCgkJYXN5bmMgY3JlYXRlQ2FuZGlkYXRlKCl7CgkJCWxldCBwYXJhbXMgPSB7CgkJCQlUb2tlbjp0aGlzLm5vdGljZUV4LmluZm8udG9rZW4sCgkJCX0KCQkJbGV0IHJlcyA9IGF3YWl0IHRoaXMubm90aWNlRXgubm90aWNlR2V0KCIvY2hhcnQvY3JlYXRlY2FuZGlkYXRlIixwYXJhbXMpCgkJfSwKCX0sCgltb3VudGVkKCkgewoJCWNvbnNvbGUubG9nKHRoaXMubm90aWNlRXgpCgkJc2V0VGltZW91dCgoKT0+ewoJCQkvL3RoaXMucmVnaXN0ZXJDdXN0b21lclNlcnZlKCkKCQkJdGhpcy5jcmVhdGVDYW5kaWRhdGUoKQoJCX0sMTAwMCkKCQl0aGlzLiRldmVuLiRvbigibm90aWNlX2NzX2luZm8iLChpbmZvKT0+ewoJCQlsZXQgY29udGVudCA9IGluZm8uRGF0YS5NZXNzYWdlOwoJCQkvL2NhbmRpZGF0ZSDlvoXmjqXpqbMKCQkJaWYoY29udGVudC5UeXBlID09ICJjYW5kaWRhdGUiKXsKCQkJCXRoaXMuY2FuZGlkYXRlLnB1c2goY29udGVudCk7CgkJCX0KCQl9KQoJfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"pages/main/im","sourcesContent":["<template>\r\n\t<div style=\"height:90%\">\r\n\t\t<el-row style=\"height:100%\">\r\n\t\t\t<el-col :span=\"24\" style=\"height:100%\">\r\n\t\t\t\t<el-row type=\"flex\" :gutter=\"10\" style=\"height:100%\">\r\n\t\t\t\t\t<!-- 消息组 -->\r\n\t\t\t\t\t<el-col :span=\"4\" style=\"height:100%;border-right: 1px solid #CCCCCC;\">\r\n\t\t\t\t\t\t<el-row :span=\"24\">\r\n\t\t\t\t\t\t\t<p style=\"height:36px;padding: 18px 0;border-bottom: 1px solid   #CCCCCC;margin: 0;line-height: 36px;text-align: center;\">咨询用户列表</p>\r\n\t\t\t\t\t\t\t<el-row style=\"height: calc(100% - 72px)\">\r\n\t\t\t\t\t\t\t\t<el-col :span=\"24\">\r\n\t\t\t\t\t\t\t\t\t<el-row v-for=\"(item,index) in candidate\" :key=\"index\" style=\"height:80px\">\r\n\t\t\t\t\t\t\t\t\t\t<!-- <el-col :span=\"6\">\r\n\t\t\t\t\t\t\t\t\t\t\t<el-avatar :size=\"40\" src=\"../../../src/assets/images/user.png\"></el-avatar>\r\n\t\t\t\t\t\t\t\t\t\t</el-col> -->\r\n\t\t\t\t\t\t\t\t\t\t<el-col :span=\"18\">\r\n\t\t\t\t\t\t\t\t\t\t\t<p @click=\"getCurrentCustomer(item)\" style=\"margin:0;padding: 0;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{{ item.UserName }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span style=\"font-size: 12px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span v-if=\"item.ChartRoomGuid && item.ChartRoomGuid.length > 0\" style=\"color:#42B983\">(正在服务..)</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span v-if=\"!item.ChartRoomGuid || item.ChartRoomGuid.length == 0\" style=\"color:#fa2541\">(待服务)</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- <p style=\"margin:0;padding: 0;font-size: 14px;\">{{ item.UserName }}</p> -->\r\n\t\t\t\t\t\t\t\t\t\t</el-col>\r\n\t\t\t\t\t\t\t\t\t</el-row>\r\n\t\t\t\t\t\t\t\t</el-col>\r\n\t\t\t\t\t\t\t</el-row>\t\r\n\t\t\t\t\t\t</el-row>\r\n\t\t\t\t\t</el-col>\t\r\n\t\t\t\t\t<!-- 消息窗口 -->\r\n\t\t\t\t\t<el-col :span=\"20\" style=\"height:100%\">\r\n\t\t\t\t\t\t<div style=\"height:calc(100% - 100px)\">\r\n\t\t\t\t\t\t\t<div style=\"width:100%;height:40px\">\r\n\t\t\t\t\t\t\t\t<el-button @click=\"connection()\" v-if=\"current.Type == 'candidate'\" style=\"float: right;width:80px;padding: 10px 0\" type=\"primary\">认领</el-button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div style=\"height:500px;overflow: scroll;background: #eee;padding:15px\">\r\n\t\t\t\t\t\t\t\t<div v-for=\"(item,index) in chartsHistory\" :key=\"index\" style=\"height:auto;margin-bottom: 20px;\">\r\n\t\t\t\t\t\t\t\t\t<div v-if=\"item.Type=='rece'\" style=\"margin:7px 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\txxx:\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div style=\"background: #6a987b;color:#fff;padding:3px 7px;border-radius: 7px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{{ item.Message }}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div v-if=\"item.Type=='sys'\" style=\"color:#ccc;font-size: 13px;text-align: center;margin:10px 0px\">\r\n\t\t\t\t\t\t\t\t\t\t{{ item.Message }}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div v-if=\"item.Type=='send'\" style=\"margin:7px 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t<div style=\"text-align:right\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div style=\"font-size: 14px;color:#ccc;margin-bottom: 5px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t我\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div style=\"background: #429844;color:#fff;padding:3px 7px;border-radius: 7px;display: inline-block;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{{ item.Message }}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\t\t\t\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div style=\"height:100px;width:70%;margin:0 20px\">\r\n\t\t\t\t\t\t\t<el-input size=\"medium\" v-model=\"sendText\"  placeholder=\"请输入内容\"  type=\"textarea\"></el-input>\r\n\t\t\t\t\t\t\t<el-button @click=\"sendInfo()\" type=\"primary\" plain style=\"float: right;width:70px;padding: 10px 0;margin:0 2px;\">发送</el-button>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" plain style=\"float: right;width:60px;padding: 10px 0;\" icon=\"el-icon-picture-outline\"></el-button>\r\n\t\t\t\t\t\t\t<el-button @click=\"sendText = ''\"  size=\"mini\"  icon=\"el-icon-delete\" circle style=\"float: right;padding: 10px 0\"></el-button>\r\n\t\t\t\t\t\t</div>\t\t\t\t\r\n\t\t\t\t\t</el-col>\r\n\t\t\t\t\t\r\n\t\t\t\t</el-row>\r\n\t\t\t\t\r\n\t\t\t</el-col>\r\n\t\t</el-row>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport {mapState,mapMutations} from 'vuex'\r\n\texport default {\r\n\t\tcomputed: {\r\n\t\t\t...mapState([\"noticeEx\"]),\r\n\t\t},\r\n\t\tdata(){\r\n\t\t\treturn {\r\n\t\t\t\ttabPosition: 'left',\r\n\t\t\t\tcircleUrl: \"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png\",\r\n\t\t\t\tsizeList: [\"large\", \"medium\", \"small\"],\r\n\t\t\t\tsendText:\"\",\r\n\t\t\t\tcurrent:{},\r\n\t\t\t\tchartsHistory:[],\r\n\t\t\t\tcandidate:[],\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods:{\r\n\t\t\tgetSender(){\r\n\t\t\t\treturn {\r\n\t\t\t\t\t\"Token\":this.noticeEx.info.token,\r\n\t\t\t\t\t\"Type\":\"app\",\r\n\t\t\t\t\t\"From\":{\r\n\t\t\t\t\t\t\"Name\":this.noticeEx.info.user.name,\r\n\t\t\t\t\t\t\"Guid\":this.noticeEx.info.user.guid,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\"Data\":{\r\n\t\t\t\t\t\t\"Message\":\"\",\r\n\t\t\t\t\t\t\"Accept\":{\r\n\t\t\t\t\t\t\t\"Guid\":\"\"\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\"Type\":\"cs\"\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsendInfo(){\r\n\t\t\t\tthis.chartsHistory.push({\r\n\t\t\t\t\tType:\"send\",\r\n\t\t\t\t\tMessage:this.sendText,\r\n\t\t\t\t})\r\n\t\t\t\tlet sender = this.getSender()\r\n\t\t\t\tsender.Data.Accept.Guid =this.current.ChartRoomGuid;\r\n\t\t\t\tsender.Data.Message = this.sendText;\r\n\t\t\t\ttry{\r\n\t\t\t\tthis.noticeEx.sendSocure(sender);\r\n\t\t\t\t}catch(e){\r\n\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t}\r\n\t\t\t\tthis.sendText = '';\r\n\t\t\t},\r\n\t\t\tgetCurrentCustomer(item){\r\n\t\t\t\tthis.current = item;\r\n\t\t\t\tthis.chartsHistory = [];\r\n\t\t\t\tif(item.Type != \"candidate\"){\r\n\t\t\t\t\t//get charts history\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync connection(){\r\n\t\t\t\tlet params = {\r\n\t\t\t\t\tToken:this.noticeEx.info.token,\r\n\t\t\t\t\tUserGuid:this.current.UserGuid,\r\n\t\t\t\t\tUserName:this.current.UserName,\r\n\t\t\t\t\tChartRoomName:\"与\"+this.current.UserName+\"的聊天\",\r\n\t\t\t\t\tAppId:\"\",\r\n\t\t\t\t}\r\n\t\t\t\tlet res = await this.noticeEx.noticeGet(\"/chart/connection\",params)\r\n\t\t\t\tif(!res.Success){\r\n\t\t\t\t\tthis.$tips.warning(\"认领错误\");\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tthis.current.ChartRoomGuid = res.Data.ChartRoomGuid;\r\n\t\t\t\t\r\n\t\t\t\tthis.chartsHistory.push({\r\n\t\t\t\t\tType:\"sys\",\r\n\t\t\t\t\tMessage:\"您已认领与\"+this.current.UserName+\"的沟通\",\r\n\t\t\t\t})\r\n\t\t\t\tconsole.log(res)\r\n\t\t\t},\r\n\t\t\tasync registerCustomerServe(){\r\n\t\t\t\tlet params = {\r\n\t\t\t\t\tToken:this.noticeEx.info.token,\r\n\t\t\t\t\tRole:2\r\n\t\t\t\t}\r\n\t\t\t\tlet res = await this.noticeEx.noticeGet(\"/chart/setrole\",params)\r\n\t\t\t\tconsole.log(res)\r\n\t\t\t},\r\n\t\t\tasync createCandidate(){\r\n\t\t\t\tlet params = {\r\n\t\t\t\t\tToken:this.noticeEx.info.token,\r\n\t\t\t\t}\r\n\t\t\t\tlet res = await this.noticeEx.noticeGet(\"/chart/createcandidate\",params)\r\n\t\t\t},\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tconsole.log(this.noticeEx)\r\n\t\t\tsetTimeout(()=>{\r\n\t\t\t\t//this.registerCustomerServe()\r\n\t\t\t\tthis.createCandidate()\r\n\t\t\t},1000)\r\n\t\t\tthis.$even.$on(\"notice_cs_info\",(info)=>{\r\n\t\t\t\tlet content = info.Data.Message;\r\n\t\t\t\t//candidate 待接驳\r\n\t\t\t\tif(content.Type == \"candidate\"){\r\n\t\t\t\t\tthis.candidate.push(content);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n  .clearfix{zoom:1}\r\n  .clearfix:after{content:\" \";display:block;clear:both;height:0}\r\n  .is-left{width:100%}\r\n</style>\r\n"]}]}