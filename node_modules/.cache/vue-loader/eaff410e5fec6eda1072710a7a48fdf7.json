{"remainingRequest":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GaeaProject\\jpn_medical_web\\pages\\common\\live.vue?vue&type=style&index=0&id=10300036&scoped=true&lang=css&","dependencies":[{"path":"D:\\GaeaProject\\jpn_medical_web\\pages\\common\\live.vue","mtime":1601201779775},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\sass-resources-loader\\lib\\loader.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmNvbnRlbnR7Cglwb3NpdGlvbjogYWJzb2x1dGU7CgloZWlnaHQ6MTAwJTsKCXdpZHRoOjEwMCU7CgliYWNrZ3JvdW5kOiAjMDAwOwoJbWluLXdpZHRoOiA2MDBweDsKCW1pbi1oZWlnaHQ6NjAwcHg7CgliYWNrZ3JvdW5kOiAjZmZmICFpbXBvcnRhbnQ7Cglib3JkZXItcmFkaXVzOiA1cHg7Cglib3gtc2hhZG93OiAwIDFweCAxNXB4IDVweCByZ2JhKDAsMCwwLC4zKTsKCWJveC1zaXppbmc6IGJvcmRlci1ib3g7Cn0K"},{"version":3,"sources":["live.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"live.vue","sourceRoot":"pages/common","sourcesContent":["<template><!-- -->\r\n\t<vue-drag-resize v-show=\"isShowVideo\" @clicked=\"openVideo\" @dragging=\"dragging\" @dragstop=\"dragstop\" parentLimitation :isResizable=\"isOpenVideo ? true : false\" :isDraggable=\"true\" :w=\"isOpenVideo ? 1000 : 50\" :h=\"isOpenVideo ? 800 : 50\" :minw=\"isOpenVideo ? 800 : 50\" :minh=\"isOpenVideo ? 600 : 50\" :z=\"999\">\r\n\t\t<transition name=\"el-zoom-in-top\">\r\n\t\t\t<div v-show=\"isOpenVideo\" class=\"content\">\r\n\t\t\t\t<div class=\"el-dialog__header\">\r\n\t\t\t\t\t<span class=\"el-dialog__title\">对话</span>\r\n\t\t\t\t\t<span class=\"el-dialog__headerbtn\">\r\n\t\t\t\t\t\t<i @click.stop=\"isOpenVideo = false\" class=\"el-dialog__close el-icon el-icon-minus\"></i>\r\n\t\t\t\t\t\t<i @click.stop=\"closeVideo\" class=\"el-dialog__close el-icon el-icon-close\" style=\"margin-left: 15px;color:red;font-weight: 600;\"></i>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div v-if=\"loading\" class=\"el-dialog__body js-videobox\" style=\"height:calc(100% - 115px);overflow: auto;background: #5d5d5d;\">\r\n\t\t\t\t\t<div style=\"text-align: center;\">\r\n\t\t\t\t\t\t<div style=\"padding:25px;border-radius: 50%;border:1px solid #ccc;display: inline-block;\">\r\n\t\t\t\t\t\t\t<i class=\"el-icon-user-solid\" style=\"font-size: 80px;color:#ccc\"></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div style=\"color:#ccc\">\r\n\t\t\t\t\t\t\t<div v-if=\"status.code == 0\">\r\n\t\t\t\t\t\t\t\t<loading></loading>\r\n\t\t\t\t\t\t\t\t{{ $t(\"default.MODULE.LIVE.CALLED\") }}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div v-if=\"status.code == 1\">\r\n\t\t\t\t\t\t\t\t{{ $t(\"default.MODULE.LIVE.HANGUPED\") }}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div v-if=\"status.code == 2\">\r\n\t\t\t\t\t\t\t\t{{ $t(\"default.MODULE.LIVE.BUSYED\") }}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div v-if=\"status.code == 3\">\r\n\t\t\t\t\t\t\t\t{{ $t(\"default.MODULE.LIVE.NORES\") }}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div v-if=\"status.code == 4\">\r\n\t\t\t\t\t\t\t\t{{ $t(\"default.MODULE.LIVE.CANCELED\") }}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<!-- 取消 -->\r\n\t\t\t\t\t\t<div style=\"margin-top: 115px;\">\r\n\t\t\t\t\t\t\t<el-button @click=\"cancel\" type=\"danger\">{{ $t(\"default.BASIC.CANCEL\") }}</el-button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div v-show=\"!loading\" class=\"el-dialog__body\" style=\"height:calc(100% - 115px);overflow: auto;background: #5d5d5d;\">\r\n\t\t\t\t\t<room></room>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\t\t\t\r\n\t\t</transition>\r\n\t\t<transition name=\"el-zoom-in-top\">\r\n\t\t\t<el-button v-show=\"!isOpenVideo\" type=\"primary\" circle style=\"position: absolute;\"> \r\n\t\t\t\t<i class=\"el-icon-video-camera\"></i>\r\n\t\t\t</el-button>\r\n\t\t</transition>\r\n\t</vue-drag-resize>\r\n</template>\r\n\r\n<script>\r\n\timport VueDragResize from 'vue-drag-resize';\r\n\timport loading from './loading.vue'\r\n\timport {mapState,mapMutations} from 'vuex'\r\n\timport conf from '@/conf/conf.js'\r\n\timport notice from '@/utils/mixins/notice.js'\r\n\timport room from './room.vue'\r\n\tvar msg = function(){\r\n\t\treturn {\r\n\t\t\tto:'',\r\n\t\t\tinfo:{\r\n\t\t\t\t'Answer':'',\r\n\t\t\t},\r\n\t\t\ttype:''\t\t\t\r\n\t\t}\r\n\t};\r\n\t\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tVueDragResize,\r\n\t\t\tloading,\r\n\t\t\troom\r\n\t\t},\r\n\t\tmixins:[notice],\r\n\t\tcomputed: {\r\n\t\t\t//...mapState([\"uInfo\"]),\r\n\t\t\t//...mapState([\"noticeEx\"]),\r\n\t\t\t...mapState([\"noticeRoom\"]),\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tgroup:\"\",\r\n\t\t\t\tloading:true,\r\n\t\t\t\tcanMedia:true,\r\n\t\t\t\t\r\n\t\t\t\tstatus:{\r\n\t\t\t\t\tmessage:\"\",\r\n\t\t\t\t\tcode:0,//0 正在呼叫 1 挂断 2 忙碌 3 超时 4 取消\r\n\t\t\t\t\ttimer:null,\r\n\t\t\t\t\tlen:60,\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t\tloacalSteam:new MediaStream(),\r\n\t\t\t\tuserRtcs:{},\r\n\t\t\t\ttokens:{},\r\n\t\t\t\t\r\n\t\t\t\trtc:null,\r\n\t\t\t\tlocalStream:{},\r\n\t\t\t\t\r\n\t\t\t\tisShowVideo:false,\r\n\t\t\t\tnotifyList:[],\r\n\t\t\t\t\r\n\t\t\t\tisOpenVideo:true,\r\n\t\t\t\tisDragging:false,\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t...mapMutations([\"update\"]),\r\n\t\t\tcancel(){\r\n\t\t\t\tthis.$even.$emit(\"user_live_cancel\");\r\n\t\t\t\tthis.closeLive(4)\r\n\t\t\t},\r\n\t\t\tcloseVideo:function(){\r\n\t\t\t\tvar msg = {\r\n\t\t\t\t\tinfo:\"Leave\",\r\n\t\t\t\t\ttype:'cancel'\t\t\t\r\n\t\t\t\t};\r\n\t\t\t\tif(this.noticeRoom && this.noticeRoom.relay){\r\n\t\t\t\t\tthis.noticeRoom.relay(msg.to,msg.info,'cancel')\r\n\t\t\t\t\tthis.noticeRoom.close();\r\n\t\t\t\t\tthis.update({\r\n\t\t\t\t\t\tnoticeRoom: {}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.$even.$emit(\"user_live_leave\")\r\n\t\t\t\t\tthis.isShowVideo = false;\r\n\t\t\t\t}else {\r\n\t\t\t\t\tthis.cancel()\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tdragging(){\r\n\t\t\t\tthis.isDragging = true;\r\n\t\t\t},\r\n\t\t\tdragstop(){\r\n\t\t\t\tthis.isDragging = false;\r\n\t\t\t},\r\n\t\t\topenVideo(){\r\n\t\t\t\tif(!this.isOpenVideo){\r\n\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\tif(!this.isDragging){\r\n\t\t\t\t\t\t\tthis.isOpenVideo = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},200)\t\t\r\n\t\t\t\t}\t\t\t\t\t\t\r\n\t\t\t},\r\n\t\t\tcloseLive(code){\r\n\t\t\t\tthis.status.code = code;\r\n\t\t\t\tif(this.status.timer != null){\r\n\t\t\t\t\tclearInterval(this.status.timer)\r\n\t\t\t\t}\r\n\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\tthis.isShowVideo = false;\r\n\t\t\t\t},2000)\r\n\t\t\t},\r\n\t\t\tevens(){\r\n\t\t\t\tthis.$even.$on(\"user_live_leave\",(info)=>{\r\n\t\t\t\t\tthis.loading = true;\r\n\t\t\t\t})\r\n\t\t\t\t//当对方选择以视频方式接通时\r\n\t\t\t\tthis.$even.$on(\"notice_live_connectall\",(info)=>{\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t\tclearInterval(this.status.timer)\r\n\t\t\t\t\t//this.$even.$emit(\"user_room_start\",info)\r\n\t\t\t\t});\r\n\t\t\t\t//当用户发起一个视频邀请时\r\n\t\t\t\tthis.$even.$on(\"user_video_ready\",(info)=>{\r\n\t\t\t\t\tthis.status.code = 0;\r\n\t\t\t\t\tthis.isShowVideo = true;\r\n\t\t\t\t\tthis.group = info.to;\r\n\t\t\t\t\tthis.noticeEx.send(info.to,info.info,\"group\",true,\"\",\"视频邀请\",\"SET\");\r\n\t\t\t\t\tthis.status.timer = setInterval(()=>{\r\n\t\t\t\t\t\tif(this.status.len == 0){\r\n\t\t\t\t\t\t\tclearInterval(this.status.timer)\r\n\t\t\t\t\t\t\tthis.status.timer = null;\r\n\t\t\t\t\t\t\tthis.status.len = 60;\r\n\t\t\t\t\t\t\tthis.closeLive(3)\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis.status.len--;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},1000)\r\n\t\t\t\t})\r\n\t\t\t\t//当用户取消一个视频邀请时\r\n\t\t\t\tthis.$even.$on(\"user_live_cancel\",(info)=>{\r\n\t\t\t\t\tthis.noticeEx.send(this.group,{'Creater':0},\"group\",true,\"\",\"取消了视频邀请\",\"CANCEL\");\r\n\t\t\t\t})\r\n\t\t\t\t//当用户收到一个视频邀请时\r\n\t\t\t\tthis.$even.$on(\"notice_live_invitation\",(info)=>{\r\n\t\t\t\t\tthis.notify(info)\r\n\t\t\t\t\t//this.getMessage(info);\r\n\t\t\t\t})\r\n\t\t\t\t//当邀请被取消时\r\n\t\t\t\tthis.$even.$on(\"notice_live_cancelled\",(info)=>{\r\n\t\t\t\t\tthis.closeNotify(info.From.Guid);\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: this.$t(\"default.BASIC.TIP\"),\r\n\t\t\t\t\t\tmessage: this.$t(\"default.MODULE.LIVE.CANCEL_INVITATION\"),\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t//当对方主动挂断时\r\n\t\t\t\tthis.$even.$on(\"notice_live_hangup\",(info)=>{\r\n\t\t\t\t\tthis.closeLive(1)\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: this.$t(\"default.BASIC.TIP\"),\r\n\t\t\t\t\t\tmessage: this.$t(\"default.MODULE.LIVE.HANGUPED\"),\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t//当对方占线时\r\n\t\t\t\tthis.$even.$on(\"notice_live_busy\",(info)=>{\r\n\t\t\t\t\tthis.closeLive(2)\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: this.$t(\"default.BASIC.TIP\"),\r\n\t\t\t\t\t\tmessage: this.$t(\"default.MODULE.LIVE.BUSYED\"),\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tthis.$even.$on(\"user_live_agree\",(data)=>{\r\n\t\t\t\t\tthis.isShowVideo = true;\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t\tthis.$even.$emit(\"user_live_launch\")\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.initPlate();\r\n\t\t\tthis.evens();\r\n\t\t\tthis.update({\r\n\t\t\t\tnoticeRoom: {}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t.content{\r\n\t\tposition: absolute;\r\n\t\theight:100%;\r\n\t\twidth:100%;\r\n\t\tbackground: #000;\r\n\t\tmin-width: 600px;\r\n\t\tmin-height:600px;\r\n\t\tbackground: #fff !important;\r\n\t\tborder-radius: 5px;\r\n\t\tbox-shadow: 0 1px 15px 5px rgba(0,0,0,.3);\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n</style>\r\n"]}]}