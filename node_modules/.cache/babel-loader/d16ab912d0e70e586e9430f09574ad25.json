{"remainingRequest":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\babel-loader\\lib\\index.js!D:\\GaeaProject\\jpn_medical_web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\GaeaProject\\jpn_medical_web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GaeaProject\\jpn_medical_web\\pages\\common\\room.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\GaeaProject\\jpn_medical_web\\pages\\common\\room.vue","mtime":1601036332240},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRDovR2FlYVByb2plY3QvanBuX21lZGljYWxfd2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRDovR2FlYVByb2plY3QvanBuX21lZGljYWxfd2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHZpZGVvRWxlbWVudCBmcm9tICdAL3BhZ2VzL2NvbW1vbi92aWRlb0VsZW1lbnQudnVlJzsKaW1wb3J0IE5vdGljZVNESyBmcm9tICdAL3V0aWxzL25vdGljZVNESy9pbmRleC5qcyc7CmltcG9ydCBSdGNTREsgZnJvbSAnQC91dGlscy9ydGNTREsvcnRjLmpzJzsKaW1wb3J0IGNvbmYgZnJvbSAnQC9jb25mL2NvbmYuanMnOwppbXBvcnQgeyBtYWtlR3VpZCB9IGZyb20gJy4uLy4uL3NyYy91dGlscy9tYWtlR3VpZC5qcyc7CmltcG9ydCB7IG1hcFN0YXRlLCBtYXBNdXRhdGlvbnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IG5vdGljZSBmcm9tICdAL3V0aWxzL21peGlucy9ub3RpY2UuanMnOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcHV0ZWQ6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgbWFwU3RhdGUoWyJ1SW5mbyJdKSksIG1hcFN0YXRlKFsibm90aWNlUm9vbSJdKSksCiAgbWl4aW5zOiBbbm90aWNlXSwKICBjb21wb25lbnRzOiB7CiAgICB2aWRlb0VsZW1lbnQ6IHZpZGVvRWxlbWVudAogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHVzZXJTdHJlYW1zOiB7fSwKICAgICAgdXNlclJ0Y3M6IHt9LAogICAgICB0b2tlbnM6IHt9LAogICAgICBsb2NhbFN0cmVhbTogbnVsbCwKICAgICAgbWVkaWFTdHJlYW1UcmFjazogbnVsbAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGNoZWNrTWVkaWE6IGZ1bmN0aW9uIGNoZWNrTWVkaWEoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbWVkaWFEZXZpY2VzOiBuYXZpZ2F0b3IgIT0gdW5kZWZpbmVkICYmIG5hdmlnYXRvci5tZWRpYURldmljZXMgIT0gdW5kZWZpbmVkCiAgICAgIH07CiAgICB9LAogICAgY3JlYXRlVmlkZW86IGZ1bmN0aW9uIGNyZWF0ZVZpZGVvKGluZm8pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIHN0cmVhbSwgdmlkZW8sIHBhcmVudEVsZW1lbnQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuY3JlYXRlTG9jYWxTdGVhbSgpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBzdHJlYW0gPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChzdHJlYW0pIHsKICAgICAgICAgICAgICAgICAgX3RoaXMubWVkaWFTdHJlYW1UcmFjayA9IHR5cGVvZiBzdHJlYW0uc3RvcCA9PT0gJ2Z1bmN0aW9uJyA/IHN0cmVhbSA6IHN0cmVhbS5nZXRUcmFja3MoKVswXTsKICAgICAgICAgICAgICAgICAgX3RoaXMubG9jYWxTdHJlYW0gPSBzdHJlYW07CiAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2NhbFN0cmVhbScpLmlubmVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgICB2aWRlbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJyk7CiAgICAgICAgICAgICAgICAgIHZpZGVvLndpZHRoID0gMzAwOwogICAgICAgICAgICAgICAgICB2aWRlby5oZWlnaHQgPSAzMDA7CiAgICAgICAgICAgICAgICAgIHZpZGVvLmF1dG9wbGF5ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgdmlkZW8ucGxheXNpbmxpbmUgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgdmlkZW8uY29udHJvbHMgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgdmlkZW8ubXV0ZWQgPSAibXV0ZWQiOwogICAgICAgICAgICAgICAgICB2aWRlby5zcmNPYmplY3QgPSBfdGhpcy5sb2NhbFN0cmVhbTsKICAgICAgICAgICAgICAgICAgcGFyZW50RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsb2NhbFN0cmVhbSIpOwogICAgICAgICAgICAgICAgICBwYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKHZpZGVvKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoaW5mbykgX3RoaXMuJGV2ZW4uJGVtaXQoInVzZXJfdmlkZW9fcmVhZHkiLCBpbmZvKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGNyZWF0ZUxvY2FsU3RlYW06IGZ1bmN0aW9uIGNyZWF0ZUxvY2FsU3RlYW0oaW5mbykgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLmNoZWNrTWVkaWEoKS5tZWRpYURldmljZXMpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczIuJHRpcHMud2FybmluZygi5oKo55qE6K6+5aSH5LiN5pSv5oyB5aqS5L2T5bGe5oCnLOivt+WFiOaOpeWFpeehrOS7tuiuvuWkhyEiKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMzsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNjsKICAgICAgICAgICAgICAgIHJldHVybiBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSh7CiAgICAgICAgICAgICAgICAgIGF1ZGlvOiB0cnVlLAogICAgICAgICAgICAgICAgICB2aWRlbzogewogICAgICAgICAgICAgICAgICAgIHdpZHRoOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZGVhbDogMzAwCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHsKICAgICAgICAgICAgICAgICAgICAgIGlkZWFsOiAzMDAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQyLnNlbnQpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDk7CiAgICAgICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbImNhdGNoIl0oMyk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgbnVsbCk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIsIG51bGwsIFtbMywgOV1dKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY3JlYXRlUnRjU2VuZGVyOiBmdW5jdGlvbiBjcmVhdGVSdGNTZW5kZXIodWlkLCB0eXBlLCByZWFkeSkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgIHZhciB0aGF0LCBydGM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRoYXQgPSBfdGhpczM7CiAgICAgICAgICAgICAgICBydGMgPSBuZXcgUnRjU0RLKHsKICAgICAgICAgICAgICAgICAgc2VydmU6ICJzdHVuOnN0dW4uc3R1bnByb3RvY29sLm9yZzozNDc4IiwKICAgICAgICAgICAgICAgICAgcmVhZHk6IHJlYWR5LAogICAgICAgICAgICAgICAgICBqb2luOiBmdW5jdGlvbiBqb2luKHN0cmVhbSkgewogICAgICAgICAgICAgICAgICAgIHRoYXQuJHNldCh0aGF0LnVzZXJTdHJlYW1zLCB1aWQsIHsKICAgICAgICAgICAgICAgICAgICAgIHN0cmVhbTogc3RyZWFtLnN0cmVhbSwKICAgICAgICAgICAgICAgICAgICAgIGxvYWRpbmc6IHRydWUKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aGF0LnVzZXJTdHJlYW1zKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgcnRjLmljZVN0YXRlID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgaWYgKGUgPT0gImNvbm5lY3RlZCIgJiYgdGhhdC51c2VyU3RyZWFtc1t1aWRdKSB7CiAgICAgICAgICAgICAgICAgICAgdGhhdC51c2VyU3RyZWFtc1t1aWRdLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICBydGMuZGlzY29ubmVjdGVkID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgICAgICAgICAgIHZhciBvZmZlciwgc2VuZE1zZzsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ0Yy5jcmVhdGVPZmZlcih7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZlclRvUmVjZWl2ZVZpZGVvOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmZXJUb1JlY2VpdmVBdWRpbzogdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICAgIG9mZmVyID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuZE1zZyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdwdXNoJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzZXA6IG9mZmVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0Lm5vdGljZVJvb20uc2VuZCh1aWQsIHNlbmRNc2cpOwoKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgcnRjLmFkZFN0ZWFtKF90aGlzMy5sb2NhbFN0cmVhbSk7CgogICAgICAgICAgICAgICAgX3RoaXMzLnNldFVzZXJSdGNzKHJ0YywgdWlkLCB0eXBlKTsKCiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDg7CiAgICAgICAgICAgICAgICByZXR1cm4gcnRjLmNyZWF0ZU9mZmVyKHsKICAgICAgICAgICAgICAgICAgb2ZmZXJUb1JlY2VpdmVWaWRlbzogdHJ1ZSwKICAgICAgICAgICAgICAgICAgb2ZmZXJUb1JlY2VpdmVBdWRpbzogdHJ1ZQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDQuc2VudCk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHNldFVzZXJSdGNzOiBmdW5jdGlvbiBzZXRVc2VyUnRjcyhydGMsIHVpZCwgdHlwZSkgewogICAgICBpZiAoIXRoaXMudXNlclJ0Y3NbdWlkXSkgewogICAgICAgIHRoaXMudXNlclJ0Y3NbdWlkXSA9IG5ldyBPYmplY3QoKTsKICAgICAgfQoKICAgICAgdGhpcy51c2VyUnRjc1t1aWRdW3R5cGVdID0gcnRjOwogICAgfSwKICAgIGNyZWF0ZVJvb206IGZ1bmN0aW9uIGNyZWF0ZVJvb20oaW5mbywgcGFyKSB7CiAgICAgIHRoaXMuaW5pdFJvb20oaW5mbywgcGFyKTsKICAgIH0sCiAgICBjcmVhdGVSdGNSZXZpY2U6IGZ1bmN0aW9uIGNyZWF0ZVJ0Y1JldmljZSh1aWQsIHR5cGUsIHJlYWR5KSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoKSB7CiAgICAgICAgdmFyIHRoYXQsIHJ0YzsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdGhhdCA9IF90aGlzNDsKICAgICAgICAgICAgICAgIHJ0YyA9IG51bGw7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzNC51c2VyUnRjc1t1aWRdICYmIF90aGlzNC51c2VyUnRjc1t1aWRdW3R5cGVdKSB7CiAgICAgICAgICAgICAgICAgIHJ0YyA9IF90aGlzNC51c2VyUnRjc1t1aWRdW3R5cGVdOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgcnRjID0gbmV3IFJ0Y1NESyh7CiAgICAgICAgICAgICAgICAgICAgc2VydmU6ICJzdHVuOnN0dW4uc3R1bnByb3RvY29sLm9yZzozNDc4IiwKICAgICAgICAgICAgICAgICAgICByZWFkeTogcmVhZHksCiAgICAgICAgICAgICAgICAgICAgam9pbjogZnVuY3Rpb24gam9pbihzdHJlYW0pIHsKICAgICAgICAgICAgICAgICAgICAgIC8vdGhhdC4kc2V0KHRoYXQudXNlclN0cmVhbXMsdWlkLHN0cmVhbS5zdHJlYW0pCiAgICAgICAgICAgICAgICAgICAgICB0aGF0LiRzZXQodGhhdC51c2VyU3RyZWFtcywgdWlkLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmVhbTogc3RyZWFtLnN0cmVhbSwKICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZzogdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBydGMuaWNlU3RhdGUgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICBpZiAoZSA9PSAiY29ubmVjdGVkIiAmJiB0aGF0LnVzZXJTdHJlYW1zW3VpZF0pIHsKICAgICAgICAgICAgICAgICAgICB0aGF0LnVzZXJTdHJlYW1zW3VpZF0ubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OyAvL3J0Yy5zb2N1cmUuYWRkVHJhbnNjZWl2ZXIoJ2F1ZGlvJywgeyAnZGlyZWN0aW9uJzogJ3JlY3Zvbmx5JyB9KTsKICAgICAgICAgICAgICAgIC8vcnRjLnNvY3VyZS5hZGRUcmFuc2NlaXZlcigndmlkZW8nLCB7ICdkaXJlY3Rpb24nOiAncmVjdm9ubHknIH0pOwogICAgICAgICAgICAgICAgLy9ydGMuc2VuZE9mZmVyID0gZmFsc2U7CgoKICAgICAgICAgICAgICAgIHJ0Yy5hZGRTdGVhbShfdGhpczQubG9jYWxTdHJlYW0pOwoKICAgICAgICAgICAgICAgIGlmICghX3RoaXM0LnVzZXJSdGNzW3VpZF0gfHwgIV90aGlzNC51c2VyUnRjc1t1aWRdW3R5cGVdKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNC5zZXRVc2VyUnRjcyhydGMsIHVpZCwgdHlwZSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgcmV0dXJuIHJ0YzsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIsIF9jb250ZXh0NS5zZW50KTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZXZlbnM6IGZ1bmN0aW9uIGV2ZW5zKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHZhciBzZWxmID0gdGhpczsgLy90aGlzLmNyZWF0ZVZpZGVvKCk7CgogICAgICB0aGlzLiRldmVuLiRvbigidXNlcl9saXZlX2xlYXZlIiwgZnVuY3Rpb24gKGluZm8pIHsKICAgICAgICBjb25zb2xlLmxvZyhfdGhpczUubWVkaWFTdHJlYW1UcmFjayk7CiAgICAgICAgX3RoaXM1Lm1lZGlhU3RyZWFtVHJhY2sgJiYgX3RoaXM1Lm1lZGlhU3RyZWFtVHJhY2suc3RvcCgpOwogICAgICAgIF90aGlzNS5tZWRpYVN0cmVhbVRyYWNrID0gbnVsbDsKCiAgICAgICAgX3RoaXM1LmxvY2FsU3RyZWFtLmdldFRyYWNrcygpWzBdLnN0b3AoKTsKCiAgICAgICAgX3RoaXM1LmxvY2FsU3RyZWFtLmdldFRyYWNrcygpWzFdLnN0b3AoKTsKCiAgICAgICAgX3RoaXM1LmxvY2FsU3RyZWFtID0gbnVsbDsKICAgICAgfSk7CiAgICAgIHRoaXMuJGV2ZW4uJG9uKCJ1c2VyX2xpdmVfbGF1bmNoIiwgZnVuY3Rpb24gKGluZm8pIHsKICAgICAgICBfdGhpczUuY3JlYXRlVmlkZW8oaW5mbyk7CiAgICAgIH0pOyAvL+W9k+WJjeeUqOaIt+S4u+WKqOmAgOWHugoKICAgICAgdGhpcy4kZXZlbi4kb24oInVzZXJfbGl2ZV9sZWF2ZSIsIGZ1bmN0aW9uIChpbmZvKSB7CiAgICAgICAgX3RoaXM1LnVzZXJSdGNzID0ge307CiAgICAgICAgdmFyIGJveCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2pzLXZpZGVvYm94JylbMF07CiAgICAgICAgYm94LmlubmVySFRNTCA9ICIiOwogICAgICAgIF90aGlzNS51c2VyU3RyZWFtcyA9IHt9OwogICAgICB9KTsgLy/lvZPlr7nmlrnpgInmi6nku6Xop4bpopHmlrnlvI/mjqXpgJrml7YKCiAgICAgIHRoaXMuJGV2ZW4uJG9uKCJub3RpY2VfbGl2ZV9jb25uZWN0YWxsIiwgZnVuY3Rpb24gKGluZm8pIHsKICAgICAgICAvL+W9k+WJjeeUqOaIt+W3suWcqOaIv+mXtAogICAgICAgIGlmIChfdGhpczUubm90aWNlUm9vbSAmJiBfdGhpczUubm90aWNlUm9vbS5pbmZvICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgdmFyIG1zZyA9IHsKICAgICAgICAgICAgdG86IGluZm8uRnJvbS5HdWlkLAogICAgICAgICAgICBpbmZvOiB7CiAgICAgICAgICAgICAgUGxhdGU6IF90aGlzNS5ub3RpY2VSb29tLmluZm8ucGxhdGUsCiAgICAgICAgICAgICAgQ29kZTogX3RoaXM1Lm5vdGljZVJvb20uaW5mby5jb2RlLAogICAgICAgICAgICAgIFZpZGVvVHlwZTogaW5mby5EYXRhLk1lc3NhZ2UuQW5zd2VyCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHR5cGU6ICcnCiAgICAgICAgICB9OwoKICAgICAgICAgIF90aGlzNS5ub3RpY2VFeC5zZW5kKG1zZy50bywgbXNnLmluZm8pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvL+W9k+WJjeeUqOaIt+S4jeWcqOaIv+mXtAogICAgICAgICAgX3RoaXM1LmNyZWF0ZVJvb20oaW5mbyk7CiAgICAgICAgfQogICAgICB9KTsgLy/lvZPmiL/pl7Tlt7Llu7rnq4sKCiAgICAgIHRoaXMuJGV2ZW4uJG9uKCJ1c2VyX3Jvb21fY3JlYXRlIiwgZnVuY3Rpb24gKGluZm8sIG5vdGljZSkgewogICAgICAgIHZhciBtc2cgPSB7CiAgICAgICAgICB0bzogaW5mby5Gcm9tLkd1aWQsCiAgICAgICAgICBpbmZvOiB7CiAgICAgICAgICAgIFBsYXRlOiBub3RpY2UuaW5mby5wbGF0ZSwKICAgICAgICAgICAgQ29kZTogbm90aWNlLmluZm8uY29kZSwKICAgICAgICAgICAgVmlkZW9UeXBlOiBpbmZvLkRhdGEuTWVzc2FnZS5BbnN3ZXIKICAgICAgICAgIH0sCiAgICAgICAgICB0eXBlOiAnJwogICAgICAgIH07CgogICAgICAgIF90aGlzNS5ub3RpY2VFeC5zZW5kKG1zZy50bywgbXNnLmluZm8pOwogICAgICB9KTsgLy/mlLbliLDliJvlu7rmiL/pl7TmjIfku6QKCiAgICAgIHRoaXMuJGV2ZW4uJG9uKCJub3RpY2Vfcm9vbV9idWlsZCIsIGZ1bmN0aW9uIChpbmZvKSB7CiAgICAgICAgX3RoaXM1LmNyZWF0ZVJvb20oaW5mbywgewogICAgICAgICAgcGxhdGU6IGluZm8uRGF0YS5NZXNzYWdlLlBsYXRlCiAgICAgICAgfSk7CiAgICAgIH0pOyAvL+aUtuWIsOWKoOWFpeaIv+mXtOaMh+S7pAoKICAgICAgdGhpcy4kZXZlbi4kb24oIm5vdGljZV9yb29tX2pvaW4iLCBmdW5jdGlvbiAoaW5mbykgewogICAgICAgIHZhciByZWFkeSA9IGZ1bmN0aW9uIHJlYWR5KHRva2VuKSB7CiAgICAgICAgICB2YXIgcnRjID0gc2VsZi51c2VyUnRjc1tpbmZvLkRhdGEuQWNjZXB0Lkd1aWRdLmRlc2s7CiAgICAgICAgICB2YXIgc2VuZE1zZyA9IHsKICAgICAgICAgICAgdHlwZTogJ3Rva2VuJywKICAgICAgICAgICAgdG9rZW46IHRva2VuCiAgICAgICAgICB9OyAvL+ajgOafpeaYr+WQpuWtmOWcqOetieW+heaOpeaUtueahHRva2VuCgogICAgICAgICAgaWYgKF90aGlzNS50b2tlbnNbaW5mby5Gcm9tLkd1aWRdKSB7CiAgICAgICAgICAgIHJ0Yy5hZGRJY2VDYW5kaWRhdGUoX3RoaXM1LnRva2Vuc1tpbmZvLkZyb20uR3VpZF0pOwogICAgICAgICAgICBkZWxldGUgX3RoaXM1LnRva2Vuc1tpbmZvLkZyb20uR3VpZF07CiAgICAgICAgICB9CgogICAgICAgICAgc2VsZi5ub3RpY2VSb29tLnNlbmQoaW5mby5EYXRhLkFjY2VwdC5HdWlkLCBzZW5kTXNnKTsKICAgICAgICB9OwoKICAgICAgICB0cnkgewogICAgICAgICAgX3RoaXM1LmNyZWF0ZVJ0Y1NlbmRlcihpbmZvLkRhdGEuQWNjZXB0Lkd1aWQsICdkZXNrJywgcmVhZHkpLnRoZW4oZnVuY3Rpb24gKG9mZmVyKSB7CiAgICAgICAgICAgIHZhciBzZW5kTXNnID0gewogICAgICAgICAgICAgIHR5cGU6ICdwdXNoJywKICAgICAgICAgICAgICBqc2VwOiBvZmZlcgogICAgICAgICAgICB9OwogICAgICAgICAgICBzZWxmLm5vdGljZVJvb20uc2VuZChpbmZvLkRhdGEuQWNjZXB0Lkd1aWQsIHNlbmRNc2cpOwogICAgICAgICAgfSk7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgfQogICAgICB9KTsgLy/kupLmjaJ0b2tlbuaMh+S7pAoKICAgICAgdGhpcy4kZXZlbi4kb24oIm5vdGljZV9jaGFubmVsX3Rva2VuIiwgZnVuY3Rpb24gKGluZm8pIHsKICAgICAgICB2YXIgcmVjID0gaW5mby5EYXRhLk1lc3NhZ2U7IC8v5b2T6L+Z5p2h5raI5oGv5o6l5Y+X5pe277yM5pyJ5Y+v6IO95pys5Zyw5bqU562U5L+h5Luk6L+Y5pyq5Yib5bu65a6M5oiQCgogICAgICAgIGlmIChfdGhpczUudXNlclJ0Y3NbaW5mby5Gcm9tLkd1aWRdKSB7CiAgICAgICAgICB2YXIgcnRjID0gX3RoaXM1LnVzZXJSdGNzW2luZm8uRnJvbS5HdWlkXS5kZXNrOwogICAgICAgICAgcnRjLmFkZEljZUNhbmRpZGF0ZShyZWMudG9rZW4pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvL+aaguWtmAogICAgICAgICAgX3RoaXM1LnRva2Vuc1tpbmZvLkZyb20uR3VpZF0gPSByZWMudG9rZW47CiAgICAgICAgfQogICAgICB9KTsgLy/mlLbliLDpgIDlh7rmiL/pl7TmjIfku6QKCiAgICAgIHRoaXMuJGV2ZW4uJG9uKCJub3RpY2Vfcm9vbV9sZWF2ZSIsIGZ1bmN0aW9uIChpbmZvKSB7CiAgICAgICAgX3RoaXM1LiRub3RpZnkoewogICAgICAgICAgdGl0bGU6ICfmj5DnpLonLAogICAgICAgICAgbWVzc2FnZTogaW5mby5EYXRhLkFjY2VwdC5OYW1lICsgJ+mAgOWHuuinhumike+8gScKICAgICAgICB9KTsKCiAgICAgICAgdmFyIHJ0YyA9IF90aGlzNS51c2VyUnRjc1tpbmZvLkRhdGEuQWNjZXB0Lkd1aWRdLmRlc2s7CiAgICAgICAgcnRjLnNvY3VyZS5jbG9zZSgpOwogICAgICAgIGRlbGV0ZSBfdGhpczUudXNlclJ0Y3NbaW5mby5EYXRhLkFjY2VwdC5HdWlkXTsKICAgICAgICB2YXIgcmVtb3ZlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaW5mby5EYXRhLkFjY2VwdC5HdWlkKTsKICAgICAgICByZW1vdmUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyZW1vdmUpOwogICAgICAgIGRlbGV0ZSBfdGhpczUudXNlclN0cmVhbXNbaW5mby5EYXRhLkFjY2VwdC5HdWlkXTsKICAgICAgfSk7IC8v5b2T5pS25YiwcHVzaOa2iOaBrwoKICAgICAgdGhpcy4kZXZlbi4kb24oIm5vdGljZV9jaGFubmVsX3B1c2giLCBmdW5jdGlvbiAoaW5mbykgewogICAgICAgIHZhciByZWMgPSBpbmZvLkRhdGEuTWVzc2FnZTsKCiAgICAgICAgdmFyIHJlYWR5ID0gZnVuY3Rpb24gcmVhZHkodG9rZW4pIHsKICAgICAgICAgIHZhciBydGMgPSBzZWxmLnVzZXJSdGNzW2luZm8uRnJvbS5HdWlkXS5kZXNrOwogICAgICAgICAgdmFyIHNlbmRNc2cgPSB7CiAgICAgICAgICAgIHR5cGU6ICd0b2tlbicsCiAgICAgICAgICAgIHRva2VuOiB0b2tlbgogICAgICAgICAgfTsgLy/mo4Dmn6XmmK/lkKblrZjlnKjnrYnlvoXmjqXmlLbnmoR0b2tlbgoKICAgICAgICAgIGlmIChfdGhpczUudG9rZW5zW2luZm8uRnJvbS5HdWlkXSkgewogICAgICAgICAgICBydGMuYWRkSWNlQ2FuZGlkYXRlKF90aGlzNS50b2tlbnNbaW5mby5Gcm9tLkd1aWRdKTsKICAgICAgICAgICAgZGVsZXRlIF90aGlzNS50b2tlbnNbaW5mby5Gcm9tLkd1aWRdOwogICAgICAgICAgfQoKICAgICAgICAgIF90aGlzNS5ub3RpY2VSb29tLnNlbmQoaW5mby5Gcm9tLkd1aWQsIHNlbmRNc2cpOwogICAgICAgIH07CgogICAgICAgIHRyeSB7CiAgICAgICAgICBfdGhpczUuY3JlYXRlUnRjUmV2aWNlKGluZm8uRnJvbS5HdWlkLCAnZGVzaycsIHJlYWR5KS50aGVuKGZ1bmN0aW9uIChydGMpIHsKICAgICAgICAgICAgcnRjLmNyZWF0ZUFuc3dlcihyZWMuanNlcCkudGhlbihmdW5jdGlvbiAoYW5zd2VyKSB7CiAgICAgICAgICAgICAgdmFyIHNlbmRNc2cgPSB7CiAgICAgICAgICAgICAgICB0eXBlOiAnc3Vic2NyaWJlJywKICAgICAgICAgICAgICAgIGpzZXA6IGFuc3dlcgogICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgIF90aGlzNS5ub3RpY2VSb29tLnNlbmQoaW5mby5Gcm9tLkd1aWQsIHNlbmRNc2cpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgIH0KICAgICAgfSk7IC8v5b2T5pS25Yiw6K6i6ZiF5raI5oGvCgogICAgICB0aGlzLiRldmVuLiRvbigibm90aWNlX2NoYW5uZWxfc3Vic2NyaWJlIiwgZnVuY3Rpb24gKGluZm8pIHsKICAgICAgICB2YXIgcmVjID0gaW5mby5EYXRhLk1lc3NhZ2U7CiAgICAgICAgdmFyIHJ0YyA9IF90aGlzNS51c2VyUnRjc1tpbmZvLkZyb20uR3VpZF0uZGVzazsKICAgICAgICBydGMuc2V0UmVtb3RlKHJlYy5qc2VwKTsKICAgICAgfSk7CiAgICB9CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5ldmVucygpOwogIH0KfTs="},{"version":3,"sources":["room.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<el-row>\r\n\t\t<el-col :span=\"24\">\r\n\t\t\t<el-row>\r\n\t\t\t\t<el-col :span=\"8\">\r\n\t\t\t\t\t<el-card id=\"localStream\" style=\"display: inline-block;\">\r\n\t\t\t\t\t</el-card>\r\n\t\t\t\t</el-col>\r\n\t\t\t\t<el-col :span=\"16\">\r\n\t\t\t\t\t<div class=\"js-videobox\">\r\n\t\t\t\t\t\t<videoElement :loading=\"item.loading\" v-for=\"(item,key,i) in userStreams\" :key=\"i\" :mid=\"key\" :stream=\"item.stream\"></videoElement>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-col>\r\n\t\t\t</el-row>\r\n\t\t</el-col>\r\n\t</el-row>\r\n</template>\r\n\r\n<script>\r\n\timport videoElement from '@/pages/common/videoElement.vue'\r\n\timport NoticeSDK from '@/utils/noticeSDK/index.js'\r\n\timport RtcSDK from '@/utils/rtcSDK/rtc.js'\r\n\timport conf from '@/conf/conf.js'\r\n\timport {makeGuid} from '../../src/utils/makeGuid.js';\r\n\timport {mapState,mapMutations} from 'vuex'\r\n\timport notice from '@/utils/mixins/notice.js'\r\n\t\r\n\texport default {\r\n\t\tcomputed: {\r\n\t\t\t...mapState([\"uInfo\"]),\r\n\t\t\t...mapState([\"noticeRoom\"]),\r\n\t\t},\r\n\t\tmixins:[notice],\r\n\t\tcomponents:{\r\n\t\t\tvideoElement\r\n\t\t},\r\n\t\tdata(){\r\n\t\t\treturn {\r\n\t\t\t\tuserStreams:{},\r\n\t\t\t\tuserRtcs:{},\r\n\t\t\t\ttokens:{},\r\n\t\t\t\tlocalStream:null,\r\n\t\t\t\tmediaStreamTrack:null,\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods:{\r\n\t\t\tcheckMedia(){\r\n\t\t\t\treturn {\r\n\t\t\t\t\tmediaDevices:navigator != undefined && navigator.mediaDevices != undefined,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync createVideo(info){\t\t\t\r\n\t\t\t\tlet stream = await this.createLocalSteam();\r\n\t\t\t\tif(stream){\r\n\t\t\t\t\tthis.mediaStreamTrack= typeof stream.stop==='function'?stream:stream.getTracks()[0];\r\n\t\t\t\t\tthis.localStream = stream;\r\n\t\t\t\t\tdocument.getElementById('localStream').innerHTML = \"\";\r\n\t\t\t\t\tconst video = document.createElement('video');\r\n\t\t\t\t\tvideo.width = 300;\r\n\t\t\t\t\tvideo.height = 300;\r\n\t\t\t\t\tvideo.autoplay = true;\r\n\t\t\t\t\tvideo.playsinline = false;\r\n\t\t\t\t\tvideo.controls = false;\r\n\t\t\t\t\tvideo.muted = \"muted\";\r\n\t\t\t\t\tvideo.srcObject = this.localStream;\r\n\t\t\t\t\tlet parentElement = document.getElementById(\"localStream\");\r\n\t\t\t\t\tparentElement.appendChild(video);\r\n\t\t\t\t}\r\n\t\t\t\tif(info)\r\n\t\t\t\t\tthis.$even.$emit(\"user_video_ready\",info)\r\n\t\t\t},\r\n\t\t\tasync createLocalSteam(info) {\r\n\t\t\t\t// console.log(this.checkMedia().mediaDevices);\r\n\t\t\t\tif (!this.checkMedia().mediaDevices) {\r\n\t\t\t\t\tthis.$tips.warning(\"您的设备不支持媒体属性,请先接入硬件设备!\")\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\ttry{\r\n\t\t\t\t\treturn await navigator.mediaDevices.getUserMedia({\r\n\t\t\t\t\t\taudio: true,\r\n\t\t\t\t\t\tvideo: {\r\n\t\t\t\t\t\t\twidth: {\r\n\t\t\t\t\t\t\t\tideal: 300\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\theight: {\r\n\t\t\t\t\t\t\t\tideal: 300\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}catch(e){\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync createRtcSender(uid, type,ready) {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tlet rtc = new RtcSDK({\r\n\t\t\t\t\tserve: \"stun:stun.stunprotocol.org:3478\",\r\n\t\t\t\t\tready:ready,\r\n\t\t\t\t\tjoin(stream){\r\n\t\t\t\t\t\tthat.$set(that.userStreams, uid, {stream:stream.stream,loading:true})\r\n\t\t\t\t\t\tconsole.log(that.userStreams)\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t\trtc.iceState = (e)=>{\r\n\t\t\t\t\tif(e == \"connected\" && that.userStreams[uid]){\r\n\t\t\t\t\t\tthat.userStreams[uid].loading = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\trtc.disconnected= async ()=>{\r\n\t\t\t\t\tlet offer = await rtc.createOffer({\r\n\t\t\t\t\t\tofferToReceiveVideo: true,\r\n\t\t\t\t\t\tofferToReceiveAudio: true\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlet sendMsg = {\r\n\t\t\t\t\t\ttype:'push',\r\n\t\t\t\t\t\tjsep:offer,\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthat.noticeRoom.send(uid, sendMsg);\r\n\t\t\t\t}\r\n\t\t\t\trtc.addSteam(this.localStream);\r\n\t\t\t\tthis.setUserRtcs(rtc, uid, type);\r\n\t\t\t\treturn await rtc.createOffer({\r\n\t\t\t\t\tofferToReceiveVideo: true,\r\n\t\t\t\t\tofferToReceiveAudio: true\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsetUserRtcs(rtc,uid,type){\r\n\t\t\t\tif(!this.userRtcs[uid]){\r\n\t\t\t\t\tthis.userRtcs[uid] = new Object();\r\n\t\t\t\t}\r\n\t\t\t\tthis.userRtcs[uid][type] = rtc;\t\r\n\t\t\t},\r\n\t\t\tcreateRoom(info,par){\r\n\t\t\t\tthis.initRoom(info,par);\r\n\t\t\t},\r\n\t\t\tasync createRtcRevice(uid,type,ready){\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tlet rtc = null;\r\n\t\t\t\tif(this.userRtcs[uid] && this.userRtcs[uid][type]){\r\n\t\t\t\t\trtc = this.userRtcs[uid][type];\r\n\t\t\t\t}else{\r\n\t\t\t\t\trtc = new RtcSDK({\r\n\t\t\t\t\t\tserve:\"stun:stun.stunprotocol.org:3478\",\r\n\t\t\t\t\t\tready:ready,\r\n\t\t\t\t\t\tjoin(stream){\r\n\t\t\t\t\t\t\t//that.$set(that.userStreams,uid,stream.stream)\r\n\t\t\t\t\t\t\tthat.$set(that.userStreams, uid, {stream:stream.stream,loading:true})\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\trtc.iceState = (e)=>{\r\n\t\t\t\t\tif(e == \"connected\" && that.userStreams[uid]){\r\n\t\t\t\t\t\tthat.userStreams[uid].loading = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t//rtc.socure.addTransceiver('audio', { 'direction': 'recvonly' });\r\n\t\t\t\t//rtc.socure.addTransceiver('video', { 'direction': 'recvonly' });\r\n\t\t\t\t//rtc.sendOffer = false;\r\n\t\t\t\trtc.addSteam(this.localStream);\t\t\t\r\n\t\t\t\tif(!this.userRtcs[uid] || !this.userRtcs[uid][type]){\r\n\t\t\t\t\tthis.setUserRtcs(rtc,uid,type);\r\n\t\t\t\t}\r\n\t\t\t\treturn await rtc;\r\n\t\t\t\t//return await rtc.createOffer({ offerToReceiveVideo: true, offerToReceiveAudio: true });\r\n\t\t\t},\r\n\t\t\tevens(){\r\n\t\t\t\tlet self = this;\r\n\t\t\t\t//this.createVideo();\r\n\t\t\t\tthis.$even.$on(\"user_live_leave\",(info)=>{\r\n\t\t\t\t\tconsole.log(this.mediaStreamTrack)\r\n\t\t\t\t\tthis.mediaStreamTrack && this.mediaStreamTrack.stop();\r\n\t\t\t\t\tthis.mediaStreamTrack = null;\r\n\t\t\t\t\tthis.localStream.getTracks()[0].stop();\r\n\t\t\t\t\tthis.localStream.getTracks()[1].stop();\r\n\t\t\t\t\tthis.localStream = null;\r\n\t\t\t\t})\r\n\t\t\t\tthis.$even.$on(\"user_live_launch\",(info)=>{\r\n\t\t\t\t\tthis.createVideo(info);\r\n\t\t\t\t})\r\n\t\t\t\t//当前用户主动退出\r\n\t\t\t\tthis.$even.$on(\"user_live_leave\",(info)=>{\r\n\t\t\t\t\tthis.userRtcs = {};\r\n\t\t\t\t\tlet box = document.getElementsByClassName('js-videobox')[0];\r\n\t\t\t\t\tbox.innerHTML = \"\";\r\n\t\t\t\t\tthis.userStreams = {};\r\n\t\t\t\t})\r\n\t\t\t\t//当对方选择以视频方式接通时\r\n\t\t\t\tthis.$even.$on(\"notice_live_connectall\",(info)=>{\r\n\t\t\t\t\t//当前用户已在房间\r\n\t\t\t\t\tif(this.noticeRoom&&this.noticeRoom.info != undefined){\r\n\t\t\t\t\t\tvar msg = {\r\n\t\t\t\t\t\t\tto: info.From.Guid,\r\n\t\t\t\t\t\t\tinfo: {\r\n\t\t\t\t\t\t\t\tPlate: this.noticeRoom.info.plate,\r\n\t\t\t\t\t\t\t\tCode: this.noticeRoom.info.code,\r\n\t\t\t\t\t\t\t\tVideoType:  info.Data.Message.Answer\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\ttype: ''\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.noticeEx.send(msg.to, msg.info);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t//当前用户不在房间\r\n\t\t\t\t\t\tthis.createRoom(info)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t//当房间已建立\r\n\t\t\t\tthis.$even.$on(\"user_room_create\",(info,notice)=>{\r\n\t\t\t\t\tvar msg = {\r\n\t\t\t\t\t\tto: info.From.Guid,\r\n\t\t\t\t\t\tinfo: {\r\n\t\t\t\t\t\t\tPlate: notice.info.plate,\r\n\t\t\t\t\t\t\tCode: notice.info.code,\r\n\t\t\t\t\t\t\tVideoType: info.Data.Message.Answer,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttype: ''\r\n\t\t\t\t\t};\t\r\n\t\t\t\t\tthis.noticeEx.send(msg.to, msg.info);\r\n\t\t\t\t});\r\n\t\t\t\t//收到创建房间指令\r\n\t\t\t\tthis.$even.$on(\"notice_room_build\",(info)=>{\r\n\t\t\t\t\tthis.createRoom(info,{plate:info.Data.Message.Plate})\r\n\t\t\t\t});\r\n\t\t\t\t//收到加入房间指令\r\n\t\t\t\tthis.$even.$on(\"notice_room_join\",(info)=>{\r\n\t\t\t\t\tlet ready = (token) => {\r\n\t\t\t\t\t\tlet rtc = self.userRtcs[info.Data.Accept.Guid].desk;\r\n\t\t\t\t\t\tlet sendMsg = {\r\n\t\t\t\t\t\t\ttype:'token',\r\n\t\t\t\t\t\t\ttoken:token,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//检查是否存在等待接收的token\r\n\t\t\t\t\t\tif(this.tokens[info.From.Guid]){\r\n\t\t\t\t\t\t\trtc.addIceCandidate(this.tokens[info.From.Guid]);\r\n\t\t\t\t\t\t\tdelete this.tokens[info.From.Guid];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.noticeRoom.send(info.Data.Accept.Guid, sendMsg);\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\tthis.createRtcSender(info.Data.Accept.Guid,'desk',ready).then((offer)=>{\r\n\t\t\t\t\t\tlet sendMsg = {\r\n\t\t\t\t\t\t\ttype:'push',\r\n\t\t\t\t\t\t\tjsep:offer,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.noticeRoom.send(info.Data.Accept.Guid, sendMsg);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t}catch(e){\r\n\t\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t//互换token指令\r\n\t\t\t\tthis.$even.$on(\"notice_channel_token\",(info)=>{\r\n\t\t\t\t\tlet rec = info.Data.Message;\r\n\t\t\t\t\t//当这条消息接受时，有可能本地应答信令还未创建完成\r\n\t\t\t\t\tif(this.userRtcs[info.From.Guid]){\r\n\t\t\t\t\t\tlet rtc = this.userRtcs[info.From.Guid].desk;\r\n\t\t\t\t\t\trtc.addIceCandidate(rec.token);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t//暂存\r\n\t\t\t\t\t\tthis.tokens[info.From.Guid] = rec.token;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t//收到退出房间指令\r\n\t\t\t\tthis.$even.$on(\"notice_room_leave\",(info)=>{\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\tmessage: info.Data.Accept.Name + '退出视频！',\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlet rtc = this.userRtcs[info.Data.Accept.Guid].desk;\r\n\t\t\t\t\trtc.socure.close();\r\n\t\t\t\t\tdelete this.userRtcs[info.Data.Accept.Guid];\r\n\t\t\t\t\tvar remove = document.getElementById(info.Data.Accept.Guid);\r\n\t\t\t\t\tremove.parentNode.removeChild(remove);\r\n\t\t\t\t\tdelete this.userStreams[info.Data.Accept.Guid]\r\n\t\t\t\t});\r\n\t\t\t\t//当收到push消息\r\n\t\t\t\tthis.$even.$on(\"notice_channel_push\",(info)=>{\r\n\t\t\t\t\tlet rec = info.Data.Message;\r\n\t\t\t\t\tlet ready = (token) => {\r\n\t\t\t\t\t\tlet rtc = self.userRtcs[info.From.Guid].desk;\r\n\t\t\t\t\t\tlet sendMsg = {\r\n\t\t\t\t\t\t\t\ttype:'token',\r\n\t\t\t\t\t\t\t\ttoken:token\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//检查是否存在等待接收的token\r\n\t\t\t\t\t\tif(this.tokens[info.From.Guid]){\r\n\t\t\t\t\t\t\trtc.addIceCandidate(this.tokens[info.From.Guid]);\r\n\t\t\t\t\t\t\tdelete this.tokens[info.From.Guid];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.noticeRoom.send(info.From.Guid, sendMsg);\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\tthis.createRtcRevice(info.From.Guid,'desk',ready).then((rtc)=>{\r\n\t\t\t\t\t\trtc.createAnswer(rec.jsep).then((answer)=>{\r\n\t\t\t\t\t\t\tlet sendMsg = {\r\n\t\t\t\t\t\t\t\t\ttype:'subscribe',\r\n\t\t\t\t\t\t\t\t\tjsep:answer,\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.noticeRoom.send(info.From.Guid, sendMsg);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t\t}catch(e){\r\n\t\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t//当收到订阅消息\r\n\t\t\t\tthis.$even.$on(\"notice_channel_subscribe\",(info)=>{\r\n\t\t\t\t\tlet rec = info.Data.Message;\r\n\t\t\t\t\tlet rtc = this.userRtcs[info.From.Guid].desk;\r\n\t\t\t\t\trtc.setRemote(rec.jsep)\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted(){\r\n\t\t\tthis.evens();\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n</style>\r\n"],"sourceRoot":"pages/common"}]}