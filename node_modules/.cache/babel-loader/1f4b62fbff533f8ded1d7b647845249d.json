{"remainingRequest":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\babel-loader\\lib\\index.js!D:\\GaeaProject\\jpn_medical_web\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\GaeaProject\\jpn_medical_web\\utils\\rtcSDK\\rtc.js","dependencies":[{"path":"D:\\GaeaProject\\jpn_medical_web\\utils\\rtcSDK\\rtc.js","mtime":1596524451947},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\GaeaProject\\jpn_medical_web\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkQ6L0dhZWFQcm9qZWN0L2pwbl9tZWRpY2FsX3dlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkQ6L0dhZWFQcm9qZWN0L2pwbl9tZWRpY2FsX3dlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwoKdmFyIFJ0Y1NESyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gUnRjU0RLKG9wdGlvbikgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJ0Y1NESyk7CgogICAgdGhpcy5zZXJ2ZSA9ICIiOwogICAgdGhpcy5zb2N1cmUgPSBudWxsOwogICAgdGhpcy5jYW5kaWRhdGUgPSAiIjsKCiAgICBpZiAob3B0aW9uKSB7CiAgICAgIHRoaXMuY29uZihvcHRpb24pOwogICAgfQogIH0KCiAgX2NyZWF0ZUNsYXNzKFJ0Y1NESywgW3sKICAgIGtleTogImFkZFN0ZWFtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRTdGVhbShzdHJlYW0pIHsKICAgICAgaWYgKHN0cmVhbSkgdGhpcy5zb2N1cmUuYWRkU3RyZWFtKHN0cmVhbSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiYWRkSWNlQ2FuZGlkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRJY2VDYW5kaWRhdGUodG9rZW4pIHsKICAgICAgdGhpcy5zb2N1cmUuYWRkSWNlQ2FuZGlkYXRlKHRva2VuKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRSZW1vdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFJlbW90ZShhbnN3ZXIpIHsKICAgICAgdGhpcy5zb2N1cmUuc2V0UmVtb3RlRGVzY3JpcHRpb24oYW5zd2VyKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjcmVhdGVBbnN3ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZUFuc3dlcihvZmZlcikgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgc2VsZi5zb2N1cmUuc2V0UmVtb3RlRGVzY3JpcHRpb24ob2ZmZXIpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgc2VsZi5zb2N1cmUuY3JlYXRlQW5zd2VyKCkudGhlbihmdW5jdGlvbiAoYW5zd2VyKSB7CiAgICAgICAgICAgIHNlbGYuc29jdXJlLnNldExvY2FsRGVzY3JpcHRpb24oYW5zd2VyKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXNvbHZlKGFuc3dlcik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImNyZWF0ZU9mZmVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVPZmZlcihvcHRpb24pIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHNlbGYuc29jdXJlLmNyZWF0ZU9mZmVyKG9wdGlvbikudGhlbihmdW5jdGlvbiAob2ZmZXIpIHsKICAgICAgICAgIHNlbGYuc29jdXJlLnNldExvY2FsRGVzY3JpcHRpb24ob2ZmZXIpOwogICAgICAgICAgcmVzb2x2ZShvZmZlcik7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJlamVjdChlKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiam9pbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gam9pbihlKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICByZXNvbHZlKGUpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZWFkeSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVhZHkoZSkge30KICB9LCB7CiAgICBrZXk6ICJkaXNjb25uZWN0ZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc2Nvbm5lY3RlZCgpIHt9CiAgfSwgewogICAga2V5OiAiaW5pdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIHVybHMgPSBbewogICAgICAgIHVybDogInR1cm46OC4xMjkuOS4yMDE6MzQ3OD90cmFuc3BvcnQ9dWRwIiwKICAgICAgICB1c2VybmFtZTogImFkbWluIiwKICAgICAgICBjcmVkZW50aWFsOiAiMTAwNTQ0IiwKICAgICAgICBjcmVkZW50aWFsVHlwZTogJ3Bhc3N3b3JkJwogICAgICB9XTsgLy90aGlzLnNvY3VyZSA9IG5ldyBSVENQZWVyQ29ubmVjdGlvbih7IGljZVNlcnZlcnM6IFt7IHVybHM6IHRoaXMuc2VydmUgfV0gfSk7CgogICAgICB0aGlzLnNvY3VyZSA9IG5ldyBSVENQZWVyQ29ubmVjdGlvbih7CiAgICAgICAgaWNlU2VydmVyczogdXJscywKICAgICAgICBpY2VUcmFuc3BvcnRQb2xpY3k6ICdyZWxheScKICAgICAgfSk7CiAgICAgIHRoaXMuc29jdXJlLnNlbmRPZmZlciA9IGZhbHNlOwoKICAgICAgdGhpcy5zb2N1cmUub25pY2VjYW5kaWRhdGUgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIGNvbnNvbGUubG9nKCJvbmljZWNhbmRpZGF0ZSIsIGUpOwoKICAgICAgICBpZiAoIV90aGlzLnNvY3VyZS5zZW5kT2ZmZXIpIHsKICAgICAgICAgIGlmIChlLmNhbmRpZGF0ZSkgewogICAgICAgICAgICBfdGhpcy5zb2N1cmUuc2VuZE9mZmVyID0gdHJ1ZTsKICAgICAgICAgICAgc2VsZi5jYW5kaWRhdGUgPSBlLmNhbmRpZGF0ZTsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgc2VsZi5yZWFkeShlLmNhbmRpZGF0ZSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHRoaXMuc29jdXJlLm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKGV2dCkgewogICAgICAgIGlmIChldnQudGFyZ2V0LmljZUNvbm5lY3Rpb25TdGF0ZSA9PSAiZGlzY29ubmVjdGVkIikgewogICAgICAgICAgX3RoaXMuZGlzY29ubmVjdGVkKCk7CiAgICAgICAgfQoKICAgICAgICBjb25zb2xlLmxvZygnSUNFIGNvbm5lY3Rpb24gc3RhdGUgY2hhbmdlOiAnICsgZXZ0KTsKICAgICAgICBjb25zb2xlLmxvZygnSUNFIGNvbm5lY3Rpb24gc3RhdGUgY2hhbmdlOiAnICsgZXZ0LnRhcmdldC5pY2VDb25uZWN0aW9uU3RhdGUpOwogICAgICB9OwoKICAgICAgdGhpcy5zb2N1cmUub25hZGRzdHJlYW0gPSBmdW5jdGlvbiAoZSkgewogICAgICAgIGNvbnNvbGUubG9nKCJvbiBqb2luOiIsIGUpOwoKICAgICAgICB0cnkgewogICAgICAgICAgc2VsZi5qb2luKGUpOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb25mIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb25mKG9wdGlvbikgewogICAgICB0aGlzLnNlcnZlID0gb3B0aW9uLnNlcnZlOwogICAgICB0aGlzLnJlYWR5ID0gb3B0aW9uLnJlYWR5OwogICAgICB0aGlzLmpvaW4gPSBvcHRpb24uam9pbjsKICAgICAgdGhpcy5pbml0KCk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUnRjU0RLOwp9KCk7CgpleHBvcnQgZGVmYXVsdCBSdGNTREs7"},{"version":3,"sources":["D:/GaeaProject/jpn_medical_web/utils/rtcSDK/rtc.js"],"names":["RtcSDK","option","serve","socure","candidate","conf","stream","addStream","token","addIceCandidate","answer","setRemoteDescription","offer","self","Promise","resolve","reject","then","createAnswer","setLocalDescription","createOffer","catch","e","urls","url","username","credential","credentialType","RTCPeerConnection","iceServers","iceTransportPolicy","sendOffer","onicecandidate","console","log","ready","oniceconnectionstatechange","evt","target","iceConnectionState","disconnected","onaddstream","join","init"],"mappings":"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","sourcesContent":["class RtcSDK {\r\n\tconstructor(option) {\r\n\t\tthis.serve = \"\";\r\n\t\tthis.socure = null;\r\n\t\tthis.candidate = \"\"\r\n\t\tif(option){\r\n\t\t\tthis.conf(option)\r\n\t\t}\r\n\t}\r\n\taddSteam(stream){\r\n\t\tif(stream)\r\n\t\t\tthis.socure.addStream(stream);\r\n\t}\r\n\taddIceCandidate(token){\r\n\t\tthis.socure.addIceCandidate(token);\r\n\t}\r\n\tsetRemote(answer){\r\n\t\tthis.socure.setRemoteDescription(answer)\r\n\t}\r\n\tcreateAnswer(offer){\r\n\t\tlet self = this;\r\n\t\treturn new Promise((resolve,reject)=>{\r\n\t\t\tself.socure.setRemoteDescription(offer).then(()=>{\r\n\t\t\t\tself.socure.createAnswer().then((answer)=>{\r\n\t\t\t\t\tself.socure.setLocalDescription(answer).then(()=>{\r\n\t\t\t\t\t\tresolve(answer);\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\tcreateOffer(option){\r\n\t\tlet self = this;\r\n\t\treturn new Promise((resolve,reject)=>{\r\n\t\t\tself.socure.createOffer(option).then((offer)=>{\r\n\t\t\t\tself.socure.setLocalDescription(offer);\r\n\t\t\t\tresolve(offer);\r\n\t\t\t}).catch((e)=>{\r\n\t\t\t\treject(e)\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\tjoin(e){\r\n\t\tlet self = this;\r\n\t\treturn new Promise((resolve,reject)=>{\r\n\t\t\tresolve(e);\r\n\t\t})\r\n\t}\r\n\tready(e){\r\n\t\t\r\n\t}\r\n\tdisconnected(){\r\n\t\t\r\n\t}\r\n\tinit(){\r\n\t\tlet self = this;\r\n\t\tlet urls = [\r\n\t\t{\r\n\t\t\turl: \"turn:8.129.9.201:3478?transport=udp\",\r\n\t\t\t\r\n\t\t\tusername: \"admin\", \r\n\t\t\tcredential: \"100544\",\r\n\t\t\tcredentialType: 'password'\r\n\t\t}]\r\n\t\t//this.socure = new RTCPeerConnection({ iceServers: [{ urls: this.serve }] });\r\n\t\tthis.socure = new RTCPeerConnection({ iceServers: urls,iceTransportPolicy: 'relay' });\r\n\t\tthis.socure.sendOffer = false;\r\n\t\tthis.socure.onicecandidate = (e)=>{\r\n\t\t\tconsole.log(\"onicecandidate\",e)\r\n\t\t\tif(!this.socure.sendOffer){\r\n\t\t\t\tif(e.candidate){\r\n\t\t\t\t\tthis.socure.sendOffer = true;\r\n\t\t\t\t\tself.candidate = e.candidate;\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\tself.ready(e.candidate);\r\n\t\t\t\t\t}catch(e){\r\n\t\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.socure.oniceconnectionstatechange = (evt) => {\r\n\t\t\tif(evt.target.iceConnectionState == \"disconnected\"){\r\n\t\t\t\tthis.disconnected();\r\n\t\t\t}\r\n\t\t\tconsole.log('ICE connection state change: ' + evt);\r\n\t\t\t\r\n\t\t\tconsole.log('ICE connection state change: ' + evt.target.iceConnectionState);\r\n\t\t};\r\n\t\tthis.socure.onaddstream = (e) => {\r\n\t\t\tconsole.log(\"on join:\",e)\r\n\t\t\ttry{\r\n\t\t\tself.join(e);\r\n\t\t\t}catch(e){\r\n\t\t\t\tconsole.log(e)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tconf(option){\r\n\t\tthis.serve = option.serve;\r\n\t\tthis.ready = option.ready;\r\n\t\tthis.join = option.join;\r\n\t\tthis.init()\r\n\t}\r\n}\r\nexport default RtcSDK;"]}]}